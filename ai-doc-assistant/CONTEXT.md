# AIæ–‡æ¡£åŠ©æ‰‹é¡¹ç›®ä¸Šä¸‹æ–‡è®°å½•

## é¡¹ç›®æ¦‚è¿°
åŸºäºEinoæ¡†æ¶æ„å»ºçš„æ™ºèƒ½æ–‡æ¡£é—®ç­”ç³»ç»Ÿï¼Œæ”¯æŒæ–‡æ¡£ä¸Šä¼ ã€å‘é‡åŒ–å­˜å‚¨ã€è¯­ä¹‰æ£€ç´¢å’ŒAIé—®ç­”ã€‚

## å½“å‰çŠ¶æ€ (2025-08-23)

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒå·¥ä½œ

#### 1. æ¶æ„é‡æ„ - é‡‡ç”¨çœŸæ­£çš„Einoæ¡†æ¶
- **ä»ç®€åŒ–ç‰ˆæœ¬é‡æ„ä¸ºçœŸå®Einoæ¡†æ¶å®ç°**
- æ›´æ–°go.modä½¿ç”¨æ­£ç¡®çš„Einoä¾èµ–ç‰ˆæœ¬ï¼š
  ```
  github.com/cloudwego/eino v0.4.4
  github.com/cloudwego/eino-ext/components/* v0.0.0-20250822083409-f8d432eea60f
  ```
- å®ç°äº†å®Œæ•´çš„EinoServiceï¼ŒåŒ…å«ï¼š
  - Embedder (ç«å±±æ–¹èˆŸå‘é‡åŒ–)
  - Milvuså‘é‡æ•°æ®åº“é›†æˆ
  - Document Transformer (Markdownåˆ†å‰²)
  - ChatModel (ç«å±±æ–¹èˆŸå¯¹è¯æ¨¡å‹)
  - å·¥å…·é›† (çŸ¥è¯†æœç´¢ã€æ–‡æ¡£å¤„ç†ã€è®¡ç®—å™¨ã€å¤©æ°”æŸ¥è¯¢ç­‰)

#### 2. è·¨å¹³å°æ”¯æŒä¼˜åŒ–
- **Makefileè·¨å¹³å°é€‚é…** (macOS/Linux/Windows)
- è‡ªåŠ¨ç³»ç»Ÿæ£€æµ‹ (å½“å‰: darwin-arm64)
- è·¨å¹³å°æ„å»ºå‘½ä»¤ `make build-all` ç”Ÿæˆæ‰€æœ‰å¹³å°ç‰ˆæœ¬ï¼š
  - ai-doc-assistant-linux-amd64
  - ai-doc-assistant-linux-arm64
  - ai-doc-assistant-darwin-amd64
  - ai-doc-assistant-darwin-arm64
  - ai-doc-assistant-windows-amd64.exe
- Windowsæ‰¹å¤„ç†å®‰è£…è„šæœ¬ `scripts/setup.bat`
- Unixå®‰è£…è„šæœ¬ `scripts/setup.sh` å¢å¼ºæ¶æ„æ£€æµ‹

#### 3. å®Œæ•´éƒ¨ç½²ç¯å¢ƒæ­å»º
- **Dockerå®¹å™¨åŒ–éƒ¨ç½²**
  - å¤šé˜¶æ®µæ„å»ºDockerfile
  - docker-compose.yml å®Œæ•´æœåŠ¡ç¼–æ’
  - docker-compose.override.yml é€‚é…ç°æœ‰ç¯å¢ƒ
- **Nginxåå‘ä»£ç†é…ç½®** (æ”¯æŒé™æ€æ–‡ä»¶ã€APIä»£ç†ã€å¥åº·æ£€æŸ¥)
- **Webç•Œé¢** - ç°ä»£åŒ–å“åº”å¼è®¾è®¡ (web/dist/index.html)

#### 4. ä»£ç ç»“æ„ä¼˜åŒ–
- ä¿®å¤ç¼–è¯‘é”™è¯¯ï¼š
  - database.go ç§»é™¤è¿‡æ—¶çš„gorm.NamingStrategy
  - åˆ›å»ºç¼ºå¤±çš„handlerå’Œmiddlewareç»„ä»¶
  - ç»Ÿä¸€å¯¼å…¥å’Œä¾èµ–ç®¡ç†
- åˆ›å»ºå®Œæ•´çš„é¡¹ç›®ç»“æ„ï¼š
  ```
  cmd/demo/main.go     # Einoæ¼”ç¤ºç¨‹åº
  cmd/server/main.go   # WebæœåŠ¡å™¨
  internal/service/eino_service.go   # æ ¸å¿ƒEinoæœåŠ¡
  internal/service/eino_tools.go     # Einoå·¥å…·å®ç°
  internal/handler/handler.go       # HTTPå¤„ç†å™¨
  pkg/middleware/middleware.go      # Ginä¸­é—´ä»¶
  ```

### ğŸ”§ æŠ€æœ¯é…ç½®

#### å½“å‰ç¯å¢ƒé…ç½®
- **æ“ä½œç³»ç»Ÿ**: macOS (Darwin 24.6.0) ARM64
- **Goç‰ˆæœ¬**: 1.24.2
- **Docker**: 28.0.1 âœ…
- **ç°æœ‰æœåŠ¡**: 
  - Milvus (localhost:19530) âœ… è¿è¡Œä¸­
  - MinIO (localhost:9000-9001) âœ…
  - etcd âœ…

#### AIæœåŠ¡é…ç½® (å·²é…ç½®)
```yaml
ai:
  provider: "volcengine"
  api_key: "d0666bb8-8a41-42f4-bd06-94ca6ba08457"
  base_url: "https://ark.cn-beijing.volces.com/api/v3"
  models:
    embedding: "doubao-embedding-text-240715"
    chat: "doubao-seed-1-6-250615"
```

#### æ•°æ®åº“é…ç½® (é€‚é…ç°æœ‰ç¯å¢ƒ)
```yaml
database:
  mysql:
    host: "localhost"
    port: 3307  # é¿å…ä¸ç°æœ‰MySQLå†²çª
  milvus:
    host: "localhost"
    port: 19530  # å¤ç”¨ç°æœ‰Milvus
  redis:
    host: "localhost" 
    port: 6380  # é¿å…ç«¯å£å†²çª
```

### ğŸš€ éƒ¨ç½²éªŒè¯ç»“æœ

#### Einoæ¡†æ¶ç»„ä»¶åˆå§‹åŒ–çŠ¶æ€
```
âœ… Embedder åˆå§‹åŒ–æˆåŠŸ
âœ… Milvus ç»„ä»¶åˆå§‹åŒ–æˆåŠŸ (åˆ›å»ºé›†åˆ: ai_assistant_documents)
âœ… Transformer åˆå§‹åŒ–æˆåŠŸ
âœ… ChatModel åˆå§‹åŒ–æˆåŠŸ  
âœ… å·¥å…·é›†åˆå§‹åŒ–æˆåŠŸ (2ä¸ªå·¥å…·)
âœ… ç³»ç»Ÿå¥åº·æ£€æŸ¥é€šè¿‡ (å‘ç°3ä¸ªMilvusé›†åˆ)
```

#### åŠŸèƒ½æµ‹è¯•çŠ¶æ€
- âœ… **æ¡†æ¶åˆå§‹åŒ–**: å®Œå…¨æˆåŠŸ
- âœ… **å‘é‡æ•°æ®åº“è¿æ¥**: æ­£å¸¸
- âœ… **APIè®¤è¯**: æˆåŠŸ (ä½¿ç”¨çœŸå®APIå¯†é’¥)
- ğŸ”„ **æ–‡æ¡£å¤„ç†åŠŸèƒ½**: å‡†å¤‡å°±ç»ª (ç­‰å¾…æµ‹è¯•æ–‡æ¡£)
- ğŸ”„ **æ™ºèƒ½é—®ç­”åŠŸèƒ½**: å‡†å¤‡å°±ç»ª (éœ€è¦å…ˆæœ‰æ–‡æ¡£æ•°æ®)

### ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„
```
ai-doc-assistant/
â”œâ”€â”€ bin/                    # æ„å»ºè¾“å‡º (æ‰€æœ‰å¹³å°ç‰ˆæœ¬)
â”œâ”€â”€ cmd/
â”‚   â”œâ”€â”€ demo/main.go       # Einoæ¼”ç¤ºç¨‹åº
â”‚   â””â”€â”€ server/main.go     # WebæœåŠ¡å™¨
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ app.yaml           # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ demo.yaml          # æ¼”ç¤ºé…ç½®
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ Dockerfile         # å¤šé˜¶æ®µæ„å»º
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/config.go
â”‚   â”œâ”€â”€ handler/handler.go
â”‚   â”œâ”€â”€ model/document.go
â”‚   â”œâ”€â”€ repository/database.go
â”‚   â””â”€â”€ service/
â”‚       â”œâ”€â”€ eino_service.go    # æ ¸å¿ƒEinoæœåŠ¡
â”‚       â””â”€â”€ eino_tools.go      # Einoå·¥å…·é›†
â”œâ”€â”€ nginx/
â”‚   â””â”€â”€ nginx.conf         # åå‘ä»£ç†é…ç½®
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ logger/logger.go
â”‚   â””â”€â”€ middleware/middleware.go
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup.sh          # Unixå®‰è£…è„šæœ¬
â”‚   â””â”€â”€ setup.bat         # Windowså®‰è£…è„šæœ¬
â”œâ”€â”€ web/
â”‚   â””â”€â”€ dist/index.html   # ç°ä»£åŒ–Webç•Œé¢
â”œâ”€â”€ docker-compose.yml    # å®Œæ•´æœåŠ¡ç¼–æ’
â”œâ”€â”€ docker-compose.override.yml  # ç¯å¢ƒé€‚é…
â”œâ”€â”€ Makefile             # è·¨å¹³å°æ„å»ºè„šæœ¬
â””â”€â”€ go.mod              # Goä¾èµ– (çœŸæ­£çš„Eino v0.4.4)
```

### ğŸ¯ å½“å‰å·¥ä½œé‡ç‚¹
1. **é¡¹ç›®å·²åŸºæœ¬å°±ç»ª** - æ‰€æœ‰æ ¸å¿ƒç»„ä»¶æ­£å¸¸è¿è¡Œ
2. **çœŸå®Einoæ¡†æ¶é›†æˆå®Œæˆ** - ä¸å†æ˜¯ç®€åŒ–ç‰ˆæœ¬
3. **APIè®¤è¯å·²é…ç½®** - ä½¿ç”¨çœŸå®ç«å±±æ–¹èˆŸå¯†é’¥
4. **è·¨å¹³å°éƒ¨ç½²æ”¯æŒ** - å®Œæ•´çš„æ„å»ºå’Œéƒ¨ç½²æµç¨‹

### ğŸ“‹ å¯æ‰§è¡Œçš„æ“ä½œå‘½ä»¤
```bash
# å¼€å‘æµ‹è¯•
make demo                    # è¿è¡Œæ¼”ç¤ºç¨‹åº  
make build                   # æ„å»ºå½“å‰å¹³å°ç‰ˆæœ¬
make build-all              # æ„å»ºæ‰€æœ‰å¹³å°ç‰ˆæœ¬
make sysinfo                # æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯

# éƒ¨ç½²è¿ç»´  
make install                # ä¸€é”®éƒ¨ç½²
make start                  # å¯åŠ¨æ‰€æœ‰æœåŠ¡
make status                 # æ£€æŸ¥æœåŠ¡çŠ¶æ€
make health                 # å¥åº·æ£€æŸ¥

# Webè®¿é—®
# http://localhost:8080      # ä¸»ç•Œé¢
# http://localhost:8080/health  # å¥åº·æ£€æŸ¥
# http://localhost:8080/swagger/index.html  # APIæ–‡æ¡£
```

### ğŸ”„ ä¸‹ä¸€æ­¥å·¥ä½œæ–¹å‘
1. **æµ‹è¯•å®Œæ•´åŠŸèƒ½æµç¨‹** - æ–‡æ¡£ä¸Šä¼ â†’å¤„ç†â†’é—®ç­”
2. **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ** - Webç•Œé¢äº¤äº’åŠŸèƒ½
3. **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²** - å®Œæ•´Docker Composeå¯åŠ¨
4. **æ€§èƒ½ä¼˜åŒ–** - å‘é‡æ£€ç´¢å’ŒAIå“åº”é€Ÿåº¦

---

## ğŸ‰ æœ€æ–°éƒ¨ç½²æˆåŠŸè®°å½• (2025-08-24)

### âœ… Dockeréƒ¨ç½²å®Œå…¨æˆåŠŸ
**éƒ¨ç½²æ—¶é—´**: 2025-08-24 ä¸Šåˆ  
**éƒ¨ç½²çŠ¶æ€**: âœ… å®Œå…¨æˆåŠŸè¿è¡Œ  

#### æœåŠ¡è®¿é—®ä¿¡æ¯
- **AIæ–‡æ¡£åŠ©æ‰‹ä¸»åº”ç”¨**: http://localhost:8082 âœ…
- **Webç•Œé¢**: http://localhost:8081 âœ…
- **APIæ–‡æ¡£**: http://localhost:8082/swagger/ âœ…
- **å®¹å™¨çŠ¶æ€**: å¥åº·è¿è¡Œ (healthy)

#### æŠ€æœ¯æ¶æ„å·²éªŒè¯
- **æ¡†æ¶**: Eino v0.4.4 âœ… å®Œå…¨é›†æˆ
- **æ•°æ®åº“è¿æ¥**: 
  - MySQL 8.0 (å®¹å™¨å: mysql8, ç«¯å£3309) âœ… è¿æ¥æˆåŠŸ
  - Milvus v2.5.10 (å®¹å™¨å: milvus-standalone, ç«¯å£19530) âœ… è¿æ¥æˆåŠŸ
  - Redis 6.2.7 (å®¹å™¨å: redis6, ç«¯å£6379) âœ… è¿æ¥æˆåŠŸ
- **AIæ¨¡å‹**: Volcengine Ark âœ…
  - å‘é‡åŒ–æ¨¡å‹: doubao-embedding-text-240715 âœ…
  - èŠå¤©æ¨¡å‹: doubao-seed-1-6-250615 âœ…

#### æˆåŠŸè§£å†³çš„æŠ€æœ¯éš¾é¢˜
1. **ç½‘ç»œè¿æ¥é—®é¢˜** âœ…
   - é—®é¢˜: åº”ç”¨æ— æ³•è¿æ¥åˆ°MySQLæ•°æ®åº“ï¼Œå‡ºç°"driver: bad connection"é”™è¯¯
   - è§£å†³: å°†æ‰€æœ‰å®¹å™¨è¿æ¥åˆ°ç»Ÿä¸€çš„`eino_default`ç½‘ç»œï¼Œä½¿ç”¨å®¹å™¨åé€šä¿¡

2. **æ¶æ„å…¼å®¹æ€§é—®é¢˜** âœ…  
   - é—®é¢˜: macOS ARM64ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶æ— æ³•åœ¨Linux AMD64å®¹å™¨ä¸­è¿è¡Œ
   - è§£å†³: å¤šé˜¶æ®µDockeræ„å»ºï¼Œåœ¨å®¹å™¨å†…ç¼–è¯‘Linuxç‰ˆæœ¬

3. **æ¨¡æ¿åŠ è½½é”™è¯¯** âœ…
   - é—®é¢˜: åº”ç”¨å¯åŠ¨æ—¶æ‰¾ä¸åˆ°HTMLæ¨¡æ¿æ–‡ä»¶è€Œå´©æºƒ
   - è§£å†³: åˆ›å»ºweb/templates/ç›®å½•ï¼Œæ›´æ–°Dockerfileå¤åˆ¶webç›®å½•

4. **ç«¯å£å†²çª** âœ…
   - é—®é¢˜: æœ¬åœ°nginxå ç”¨8080ç«¯å£
   - è§£å†³: å°†å¤–éƒ¨ç«¯å£æ˜ å°„æ”¹ä¸º8082

#### æ•°æ®åº“è¡¨ç»“æ„è‡ªåŠ¨åˆ›å»ºå®Œæˆ âœ…
- `users` - ç”¨æˆ·ä¿¡æ¯è¡¨ âœ…
- `documents` - æ–‡æ¡£å…ƒæ•°æ®è¡¨ âœ…  
- `document_chunks` - æ–‡æ¡£åˆ†å—è¡¨ âœ…
- `query_history` - æŸ¥è¯¢å†å²è¡¨ âœ…
- `document_shares` - æ–‡æ¡£å…±äº«è¡¨ âœ…

#### Einoç»„ä»¶åˆå§‹åŒ–å®Œæˆ âœ…
```
âœ… Embedder åˆå§‹åŒ–æˆåŠŸ
âœ… Milvusé›†åˆ ai_assistant_documents å·²å­˜åœ¨  
âœ… Milvus ç»„ä»¶åˆå§‹åŒ–æˆåŠŸ
âœ… Transformer åˆå§‹åŒ–æˆåŠŸ
âœ… ChatModel åˆå§‹åŒ–æˆåŠŸ
âœ… åˆå§‹åŒ–äº† 2 ä¸ªå·¥å…·
âœ… EinoæœåŠ¡åˆå§‹åŒ–å®Œæˆ
```

#### å½“å‰éƒ¨ç½²é…ç½®æ–‡ä»¶
- **docker-compose.optimized.yml**: ä¼˜åŒ–çš„Dockerç¼–æ’é…ç½®
- **docker/Dockerfile.linux**: å¤šé˜¶æ®µæ„å»ºï¼Œè§£å†³è·¨å¹³å°é—®é¢˜
- **web/templates/index.html**: åˆ›å»ºçš„Webç•Œé¢æ¨¡æ¿

#### éªŒè¯å‘½ä»¤
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€ - æ˜¾ç¤ºhealthy
docker ps | grep ai-doc-assistant

# æµ‹è¯•ä¸»åº”ç”¨ - è¿”å›JSONçŠ¶æ€
curl http://localhost:8082/

# æµ‹è¯•APIç«¯ç‚¹
curl http://localhost:8082/api/v1/stats/overview

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker logs ai-doc-assistant-app
```

### ğŸ¯ ç³»ç»Ÿç°åœ¨å®Œå…¨å°±ç»ª
- âœ… **æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ**
- âœ… **æ•°æ®åº“è¿æ¥æˆåŠŸ** 
- âœ… **APIç«¯ç‚¹å“åº”æ­£å¸¸**
- âœ… **Einoæ¡†æ¶å®Œå…¨é›†æˆ**
- âœ… **å‘é‡æ•°æ®åº“å°±ç»ª**
- âœ… **AIæ¨¡å‹è¿æ¥æ­£å¸¸**

å¯ä»¥å¼€å§‹ä½¿ç”¨å®Œæ•´çš„æ–‡æ¡£ä¸Šä¼ ã€ç´¢å¼•åŒ–ã€æ™ºèƒ½æ£€ç´¢å’ŒAIé—®ç­”åŠŸèƒ½ï¼

---
**æ›´æ–°æ—¶é—´**: 2025-08-24 09:00  
**çŠ¶æ€**: âœ… éƒ¨ç½²æˆåŠŸï¼Œç³»ç»Ÿå®Œå…¨å°±ç»ªè¿è¡Œ