# äº§å“æ–‡æ¡£AIåŠ©æ‰‹è®¾è®¡æ–¹æ¡ˆ

åŸºäº Eino æ¡†æ¶çš„æ™ºèƒ½æ–‡æ¡£æ£€ç´¢ç³»ç»Ÿ

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### ğŸ¯ é¡¹ç›®èƒŒæ™¯
åœ¨æ•æ·å¼€å‘æ¨¡å¼ä¸‹ï¼Œäº§å“éœ€æ±‚æ–‡æ¡£æ›´æ–°é¢‘ç¹ï¼Œå†å²ç‰ˆæœ¬ä¼—å¤šï¼Œå›¢é˜Ÿæˆå‘˜åœ¨æŸ¥æ‰¾ç‰¹å®šéœ€æ±‚ä¿¡æ¯æ—¶é¢ä¸´ä»¥ä¸‹ç—›ç‚¹ï¼š
- ğŸ“ æ–‡æ¡£åˆ†æ•£åœ¨ä¸åŒç‰ˆæœ¬å’Œæ–‡ä»¶å¤¹ä¸­
- ğŸ” å…³é”®è¯æœç´¢æ•ˆæœä¸ä½³ï¼Œæ— æ³•ç†è§£è¯­ä¹‰
- â° æŸ¥æ‰¾å†å²éœ€æ±‚è€—æ—¶è¿‡é•¿ï¼Œå½±å“å¼€å‘æ•ˆç‡
- ğŸ”„ æ–‡æ¡£æ›´æ–°åå›¢é˜ŸåŒæ­¥å›°éš¾

### ğŸ’¡ è§£å†³æ–¹æ¡ˆ
æ„å»ºä¸€ä¸ªåŸºäº Eino æ¡†æ¶çš„æ™ºèƒ½æ–‡æ¡£åŠ©æ‰‹ï¼Œå…·å¤‡ï¼š
- ğŸ¤– **æ™ºèƒ½é—®ç­”**ï¼šè‡ªç„¶è¯­è¨€æŸ¥è¯¢å†å²éœ€æ±‚
- ğŸ“š **è¯­ä¹‰æ£€ç´¢**ï¼šç†è§£éœ€æ±‚æ„å›¾ï¼Œç²¾å‡†åŒ¹é…æ–‡æ¡£
- ğŸ”„ **å®æ—¶åŒæ­¥**ï¼šè‡ªåŠ¨æ›´æ–°å‘é‡åº“ï¼Œä¿æŒæ•°æ®æœ€æ–°
- ğŸ“¢ **å›¢é˜Ÿé€šçŸ¥**ï¼šé€šè¿‡é£ä¹¦æœºå™¨äººæ¨é€æ–‡æ¡£å˜æ›´

---

## ğŸ¨ äº§å“åŠŸèƒ½è®¾è®¡

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### 1ï¸âƒ£ æ™ºèƒ½æ–‡æ¡£é—®ç­”
```
ç”¨æˆ·è¾“å…¥ï¼š
"ä¹‹å‰ç”¨æˆ·ç™»å½•åŠŸèƒ½çš„éªŒè¯ç æœ‰æ•ˆæœŸæ˜¯å¤šå°‘ï¼Ÿ"

AIåŠ©æ‰‹å›ç­”ï¼š
ğŸ“„ æ ¹æ® v2.3 äº§å“éœ€æ±‚æ–‡æ¡£ (2024-03-15)ï¼š
ç”¨æˆ·ç™»å½•éªŒè¯ç æœ‰æ•ˆæœŸè®¾å®šä¸º 5åˆ†é’Ÿ
ç›¸å…³æˆªå›¾ï¼š[éªŒè¯ç æµç¨‹å›¾]
è´Ÿè´£äººï¼š@å¼ ä¸‰ 
å…³è”éœ€æ±‚ï¼šPRD-001-ç”¨æˆ·è®¤è¯æ¨¡å—

ğŸ”— ç›¸å…³æ–‡æ¡£é“¾æ¥ï¼š
- ç”¨æˆ·è®¤è¯è¯¦ç»†è®¾è®¡ v2.3.pdf
- ç™»å½•æµç¨‹ä¼˜åŒ–æ–¹æ¡ˆ v1.2.docx
```

#### 2ï¸âƒ£ æ–‡æ¡£ç‰ˆæœ¬å¯¹æ¯”
```
ç”¨æˆ·è¾“å…¥ï¼š
"æ”¯ä»˜æ¨¡å—åœ¨æœ€è¿‘å‡ ä¸ªç‰ˆæœ¬æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ"

AIåŠ©æ‰‹å›ç­”ï¼š
ğŸ“ˆ æ”¯ä»˜æ¨¡å—ç‰ˆæœ¬å˜æ›´å†å²ï¼š

v3.1 (2024-04-10):
âœ… æ–°å¢å¾®ä¿¡æ”¯ä»˜
âœ… ä¼˜åŒ–æ”¯ä»˜è¶…æ—¶å¤„ç†

v3.0 (2024-03-20): 
âœ… æ”¯æŒæ”¯ä»˜å®
âŒ ç§»é™¤é“¶è¡Œå¡ç›´è¿

v2.8 (2024-02-15):
âœ… æ·»åŠ æ”¯ä»˜çŠ¶æ€å›è°ƒæœºåˆ¶
```

#### 3ï¸âƒ£ éœ€æ±‚å…³è”åˆ†æ
```
ç”¨æˆ·è¾“å…¥ï¼š
"è¿™ä¸ªåŠŸèƒ½ä¼šå½±å“åˆ°å“ªäº›å…¶ä»–æ¨¡å—ï¼Ÿ"

AIåŠ©æ‰‹åˆ†æï¼š
ğŸ”— å…³è”å½±å“åˆ†æï¼š

ç›´æ¥å½±å“ï¼š
- ç”¨æˆ·ä¸­å¿ƒæ¨¡å—ï¼ˆç”¨æˆ·çŠ¶æ€åŒæ­¥ï¼‰
- é€šçŸ¥æ¨¡å—ï¼ˆæ”¯ä»˜æˆåŠŸé€šçŸ¥ï¼‰

é—´æ¥å½±å“ï¼š
- è®¢å•æ¨¡å—ï¼ˆçŠ¶æ€æ›´æ–°é€»è¾‘ï¼‰
- æŠ¥è¡¨æ¨¡å—ï¼ˆè´¢åŠ¡ç»Ÿè®¡ï¼‰

å»ºè®®è¯„ä¼°ï¼š
âš ï¸  éœ€è¦åŒæ­¥æ›´æ–°ç”¨æˆ·ä¸­å¿ƒAPI
âš ï¸  é€šçŸ¥æ¨¡æ¿éœ€è¦æ·»åŠ æ–°å­—æ®µ
```

#### 4ï¸âƒ£ å®æ—¶æ–‡æ¡£ç›‘æ§
- ğŸ“ ç›‘æ§æŒ‡å®šç›®å½•çš„æ–‡æ¡£å˜æ›´
- ğŸ”„ è‡ªåŠ¨è§£ææ–°å¢/ä¿®æ”¹çš„æ–‡æ¡£
- ğŸ“Š å¢é‡æ›´æ–°å‘é‡åº“
- ğŸ“¢ é€šè¿‡é£ä¹¦æ¨é€å˜æ›´é€šçŸ¥

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é£ä¹¦ä¼ä¸šæ–‡æ¡£æº  â”‚    â”‚   Einoå¤„ç†å¼•æ“   â”‚    â”‚   ç”¨æˆ·äº¤äº’å±‚     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ é£ä¹¦æ–‡æ¡£API   â”‚â”€â”€â”€â–¶â”‚ â€¢ Transformer   â”‚â”€â”€â”€â–¶â”‚ â€¢ Webæ§åˆ¶å°     â”‚
â”‚ â€¢ å¤šç»´è¡¨æ ¼API   â”‚    â”‚ â€¢ Embedder      â”‚    â”‚ â€¢ é£ä¹¦æœºå™¨äºº     â”‚
â”‚ â€¢ çŸ¥è¯†åº“API     â”‚    â”‚ â€¢ Indexer       â”‚    â”‚ â€¢ é£ä¹¦å°ç¨‹åº     â”‚
â”‚ â€¢ Webhookç›‘å¬   â”‚    â”‚ â€¢ Retriever     â”‚    â”‚ â€¢ APIæ¥å£       â”‚
â”‚ â€¢ æƒé™åŒæ­¥      â”‚    â”‚ â€¢ ChatModel     â”‚    â”‚ â€¢ ç§»åŠ¨ç«¯åº”ç”¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   å­˜å‚¨å±‚        â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ â€¢ Milvuså‘é‡åº“  â”‚
                    â”‚ â€¢ MySQLå…ƒæ•°æ®   â”‚
                    â”‚ â€¢ Redisç¼“å­˜     â”‚
                    â”‚ â€¢ é£ä¹¦Tokenç¼“å­˜ â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæŠ€æœ¯ç»„ä»¶

#### ğŸš€ é£ä¹¦æ–‡æ¡£é›†æˆå±‚
```go
package feishu

import (
    "context"
    "encoding/json"
    "fmt"
    "log"
    "net/http"
    "time"
    
    "github.com/cloudwego/eino/chain"
    "github.com/cloudwego/eino/compose"
)

// é£ä¹¦APIå®¢æˆ·ç«¯
type FeishuDocClient struct {
    AppID       string
    AppSecret   string
    AccessToken string
    BaseURL     string
    HTTPClient  *http.Client
}

// æ–‡æ¡£ä¿¡æ¯ç»“æ„ä½“
type DocumentInfo struct {
    Token      string    `json:"token"`
    Type       string    `json:"type"`
    Title      string    `json:"title"`
    URL        string    `json:"url"`
    Owner      string    `json:"owner"`
    CreateTime time.Time `json:"create_time"`
    UpdateTime time.Time `json:"update_time"`
}

// æ–‡æ¡£å†…å®¹ç»“æ„ä½“
type DocumentContent struct {
    Content  string                 `json:"content"`
    Metadata map[string]interface{} `json:"metadata"`
}

// åˆ›å»ºé£ä¹¦APIå®¢æˆ·ç«¯
func NewFeishuDocClient(appID, appSecret string) *FeishuDocClient {
    client := &FeishuDocClient{
        AppID:     appID,
        AppSecret: appSecret,
        BaseURL:   "https://open.feishu.cn",
        HTTPClient: &http.Client{
            Timeout: 30 * time.Second,
        },
    }
    
    // è·å–è®¿é—®ä»¤ç‰Œ
    if err := client.refreshAccessToken(); err != nil {
        log.Printf("è·å–è®¿é—®ä»¤ç‰Œå¤±è´¥: %v", err)
    }
    
    return client
}

// è·å–æ‰€æœ‰å¯è®¿é—®çš„æ–‡æ¡£
func (c *FeishuDocClient) GetAllDocuments(ctx context.Context, folderToken string) ([]*DocumentInfo, error) {
    docTypes := []string{"doc", "sheet", "bitable", "wiki"}
    var allDocs []*DocumentInfo
    
    for _, docType := range docTypes {
        docs, err := c.fetchDocumentsByType(ctx, docType, folderToken)
        if err != nil {
            log.Printf("è·å– %s ç±»å‹æ–‡æ¡£å¤±è´¥: %v", docType, err)
            continue
        }
        allDocs = append(allDocs, docs...)
    }
    
    return allDocs, nil
}

// è·å–æ–‡æ¡£å…·ä½“å†…å®¹
func (c *FeishuDocClient) GetDocumentContent(ctx context.Context, docToken, docType string) (*DocumentContent, error) {
    switch docType {
    case "doc":
        return c.getDocContent(ctx, docToken)
    case "sheet":
        return c.getSheetContent(ctx, docToken)
    case "bitable":
        return c.getBitableContent(ctx, docToken)
    case "wiki":
        return c.getWikiContent(ctx, docToken)
    default:
        return nil, fmt.Errorf("ä¸æ”¯æŒçš„æ–‡æ¡£ç±»å‹: %s", docType)
    }
}

// è®¾ç½®Webhookç›‘å¬
func (c *FeishuDocClient) SetupWebhook(ctx context.Context, callbackURL string) error {
    events := []string{
        "drive.file.created_in_folder_v1",
        "drive.file.edit_v1", 
        "drive.file.title_updated_v1",
        "drive.file.trashed_v1",
    }
    
    for _, event := range events {
        if err := c.subscribeEvent(ctx, event, callbackURL); err != nil {
            log.Printf("è®¢é˜…äº‹ä»¶ %s å¤±è´¥: %v", event, err)
        }
    }
    
    return nil
}

// é£ä¹¦æ–‡æ¡£åŒæ­¥å™¨
type FeishuDocumentSyncer struct {
    client   *FeishuDocClient
    pipeline compose.Chain
}

// åˆ›å»ºæ–‡æ¡£åŒæ­¥å™¨
func NewFeishuDocumentSyncer(client *FeishuDocClient, pipeline compose.Chain) *FeishuDocumentSyncer {
    return &FeishuDocumentSyncer{
        client:   client,
        pipeline: pipeline,
    }
}

// å…¨é‡åŒæ­¥æ‰€æœ‰æ–‡æ¡£
func (s *FeishuDocumentSyncer) SyncAllDocuments(ctx context.Context) error {
    documents, err := s.client.GetAllDocuments(ctx, "")
    if err != nil {
        return fmt.Errorf("è·å–æ–‡æ¡£åˆ—è¡¨å¤±è´¥: %w", err)
    }
    
    for _, doc := range documents {
        if err := s.syncSingleDocument(ctx, doc); err != nil {
            log.Printf("åŒæ­¥æ–‡æ¡£å¤±è´¥ %s: %v", doc.Title, err)
            continue
        }
        log.Printf("åŒæ­¥æ–‡æ¡£æˆåŠŸ: %s", doc.Title)
    }
    
    return nil
}

// åŒæ­¥å•ä¸ªæ–‡æ¡£
func (s *FeishuDocumentSyncer) syncSingleDocument(ctx context.Context, doc *DocumentInfo) error {
    content, err := s.client.GetDocumentContent(ctx, doc.Token, doc.Type)
    if err != nil {
        return fmt.Errorf("è·å–æ–‡æ¡£å†…å®¹å¤±è´¥: %w", err)
    }
    
    // æ„å»ºå¤„ç†è¾“å…¥
    input := map[string]interface{}{
        "content": content.Content,
        "metadata": map[string]interface{}{
            "doc_token":   doc.Token,
            "doc_type":    doc.Type,
            "title":       doc.Title,
            "url":         doc.URL,
            "owner":       doc.Owner,
            "create_time": doc.CreateTime,
            "update_time": doc.UpdateTime,
            "source":      "feishu",
        },
    }
    
    // ä½¿ç”¨Einoå¤„ç†æ–‡æ¡£
    _, err = s.pipeline.Invoke(ctx, input)
    return err
}
```

#### ğŸ“„ æ–‡æ¡£å¤„ç†æµæ°´çº¿
```go
package pipeline

import (
    "context"
    
    "github.com/cloudwego/eino/chain"
    "github.com/cloudwego/eino/compose"
    "github.com/cloudwego/eino/components/document"
    "github.com/cloudwego/eino/components/embedding" 
    "github.com/cloudwego/eino/components/indexing"
)

// åˆ›å»ºä¸“é—¨é€‚é…é£ä¹¦æ–‡æ¡£çš„å¤„ç†æµæ°´çº¿
func NewFeishuDocumentPipeline() compose.Chain {
    // æ–‡æ¡£åŠ è½½å™¨
    docLoader := document.NewDocumentLoader(document.Config{
        ChunkSize:    512,
        ChunkOverlap: 50,
        PreserveStructure: true, // ä¿æŒé£ä¹¦æ–‡æ¡£ç»“æ„
    })
    
    // å†…å®¹åˆ†å‰²å™¨
    splitter := document.NewTextSplitter(document.SplitterConfig{
        ChunkSize:    512,
        ChunkOverlap: 50,
        Separators:   []string{"\n\n", "\n", "ã€‚", ".", " "},
    })
    
    // å‘é‡åµŒå…¥å™¨
    embedder := embedding.NewEmbedding(embedding.Config{
        Provider: "openai",
        Model:    "text-embedding-ada-002",
        APIKey:   os.Getenv("OPENAI_API_KEY"),
    })
    
    // å‘é‡ç´¢å¼•å™¨
    indexer := indexing.NewMilvusIndexer(indexing.MilvusConfig{
        Host:           "localhost:19530",
        CollectionName: "feishu_docs",
        Dimension:      1536,
        IndexType:      "IVF_FLAT",
        MetricType:     "L2",
    })
    
    // æ„å»ºå¤„ç†é“¾
    pipeline := compose.NewChain().
        AppendRunnable(docLoader).
        AppendRunnable(splitter).
        AppendRunnable(embedder).
        AppendRunnable(indexer)
    
    return pipeline
}

// é£ä¹¦æ–‡æ¡£å†…å®¹è§£æå™¨
type FeishuContentParser struct{}

func NewFeishuContentParser() *FeishuContentParser {
    return &FeishuContentParser{}
}

func (p *FeishuContentParser) Invoke(ctx context.Context, input map[string]interface{}) (map[string]interface{}, error) {
    content, ok := input["content"].(string)
    if !ok {
        return input, fmt.Errorf("invalid content type")
    }
    
    docType, _ := input["metadata"].(map[string]interface{})["doc_type"].(string)
    
    var parsedContent string
    var err error
    
    switch docType {
    case "doc":
        parsedContent, err = p.parseFeishuDoc(content)
    case "sheet":
        parsedContent, err = p.parseFeishuSheet(content)
    case "bitable":
        parsedContent, err = p.parseFeishuBitable(content)
    case "wiki":
        parsedContent, err = p.parseFeishuWiki(content)
    default:
        parsedContent = content
    }
    
    if err != nil {
        return input, err
    }
    
    input["parsed_content"] = parsedContent
    return input, nil
}

// è§£æé£ä¹¦æ–‡æ¡£
func (p *FeishuContentParser) parseFeishuDoc(content string) (string, error) {
    // è§£æé£ä¹¦æ–‡æ¡£çš„ç‰¹æ®Šæ ¼å¼
    // å¤„ç†æ ‡é¢˜ã€æ®µè½ã€è¡¨æ ¼ã€ä»£ç å—ç­‰
    return content, nil
}

// æ”¯æŒçš„é£ä¹¦æ–‡æ¡£ç±»å‹
/*
- é£ä¹¦æ–‡æ¡£ (Doc) - å¯Œæ–‡æœ¬æ–‡æ¡£ï¼Œæ”¯æŒæ ‡é¢˜ã€æ®µè½ã€è¡¨æ ¼ã€å›¾ç‰‡ç­‰
- é£ä¹¦è¡¨æ ¼ (Sheet) - æ•°æ®è¡¨æ ¼ï¼Œè‡ªåŠ¨æå–å•å…ƒæ ¼å†…å®¹ 
- å¤šç»´è¡¨æ ¼ (Bitable) - ç»“æ„åŒ–æ•°æ®ï¼Œæ”¯æŒå­—æ®µç±»å‹è¯†åˆ«
- é£ä¹¦çŸ¥è¯†åº“ (Wiki) - çŸ¥è¯†åº“é¡µé¢ï¼Œä¿æŒé¡µé¢å±‚çº§ç»“æ„
- æ€ç»´å¯¼å›¾ (MindMap) - æµç¨‹å›¾è¡¨ï¼Œæå–èŠ‚ç‚¹å’Œå…³ç³»ä¿¡æ¯
*/
```

#### ğŸ” æ™ºèƒ½æ£€ç´¢å¼•æ“
```go
package retrieval

import (
    "context"
    
    "github.com/cloudwego/eino/compose"
    "github.com/cloudwego/eino/components/retriever"
    "github.com/cloudwego/eino/components/model"
    "github.com/cloudwego/eino/components/prompt"
)

// åˆ›å»ºRAGæ£€ç´¢é“¾
func NewDocumentQAChain() compose.Chain {
    // æŸ¥è¯¢åˆ†æå™¨
    queryAnalyzer := NewQueryAnalyzer()
    
    // è¯­ä¹‰æ£€ç´¢å™¨
    semanticRetriever := retriever.NewVectorRetriever(retriever.Config{
        Collection:      "feishu_docs",
        TopK:           5,
        ScoreThreshold: 0.7,
        SearchParams: map[string]interface{}{
            "nprobe": 10,
        },
    })
    
    // ç›¸å…³æ€§è¿‡æ»¤å™¨
    relevanceFilter := NewRelevanceFilter()
    
    // ä¸Šä¸‹æ–‡èšåˆå™¨
    contextAggregator := NewContextAggregator()
    
    // å¯¹è¯æ¨¡å‹
    chatModel := model.NewChatModel(model.Config{
        Provider:    "openai",
        Model:       "gpt-4",
        Temperature: 0.1,
        MaxTokens:   2000,
    })
    
    // æ„å»ºæ£€ç´¢é“¾
    chain := compose.NewChain().
        AppendRunnable(queryAnalyzer).
        AppendRunnable(semanticRetriever).
        AppendRunnable(relevanceFilter).
        AppendRunnable(contextAggregator).
        AppendRunnable(chatModel)
    
    return chain
}

// æŸ¥è¯¢åˆ†æå™¨
type QueryAnalyzer struct{}

func NewQueryAnalyzer() *QueryAnalyzer {
    return &QueryAnalyzer{}
}

func (q *QueryAnalyzer) Invoke(ctx context.Context, input map[string]interface{}) (map[string]interface{}, error) {
    query := input["query"].(string)
    
    // åˆ†ææŸ¥è¯¢æ„å›¾
    intent := q.analyzeIntent(query)
    
    // æå–å…³é”®è¯
    keywords := q.extractKeywords(query)
    
    // æ£€æµ‹æ—¶é—´èŒƒå›´
    timeRange := q.detectTimeRange(query)
    
    // è¯†åˆ«æ–‡æ¡£ç±»å‹åå¥½
    docTypePreference := q.detectDocTypePreference(query)
    
    input["analyzed_query"] = map[string]interface{}{
        "original_query":      query,
        "intent":              intent,
        "keywords":            keywords,
        "time_range":          timeRange,
        "doc_type_preference": docTypePreference,
    }
    
    return input, nil
}

// æ–‡æ¡£é—®ç­”ç³»ç»Ÿ
type DocumentQASystem struct {
    qaChain compose.Chain
}

func NewDocumentQASystem() *DocumentQASystem {
    return &DocumentQASystem{
        qaChain: NewDocumentQAChain(),
    }
}

func (qa *DocumentQASystem) Ask(ctx context.Context, question string) (string, error) {
    input := map[string]interface{}{
        "query": question,
    }
    
    result, err := qa.qaChain.Invoke(ctx, input)
    if err != nil {
        return "", err
    }
    
    answer, ok := result["answer"].(string)
    if !ok {
        return "", fmt.Errorf("invalid answer format")
    }
    
    return answer, nil
}

// æ£€ç´¢ç­–ç•¥é…ç½®
/*
æ£€ç´¢ç­–ç•¥ï¼š
- è¯­ä¹‰ç›¸ä¼¼åº¦æ£€ç´¢ï¼ˆä¸»è¦ï¼‰: ä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦åŒ¹é…
- å…³é”®è¯åŒ¹é…æ£€ç´¢ï¼ˆè¾…åŠ©ï¼‰: è¡¥å……ä¼ ç»Ÿæ–‡æœ¬åŒ¹é…  
- æ—¶é—´èŒƒå›´è¿‡æ»¤: æ”¯æŒ"æœ€è¿‘ä¸€ä¸ªæœˆ"ç­‰æ—¶é—´æŸ¥è¯¢
- æ–‡æ¡£ç±»å‹è¿‡æ»¤: å¯æŒ‡å®šæŸ¥è¯¢ç‰¹å®šç±»å‹æ–‡æ¡£
- ä½œè€…/è´Ÿè´£äººè¿‡æ»¤: æŒ‰æ–‡æ¡£åˆ›å»ºè€…æˆ–è´Ÿè´£äººç­›é€‰
- æƒé™æ£€æŸ¥: ç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®æœ‰æƒé™çš„æ–‡æ¡£
*/
```

#### ğŸ”„ é£ä¹¦å®æ—¶æ›´æ–°æœºåˆ¶
```go
package webhook

import (
    "context"
    "encoding/json"
    "fmt"
    "log"
    "net/http"
    "time"
    
    "github.com/gin-gonic/gin"
)

// é£ä¹¦äº‹ä»¶æ•°æ®ç»“æ„
type FeishuEvent struct {
    Schema string `json:"schema"`
    Header struct {
        EventID    string `json:"event_id"`
        EventType  string `json:"event_type"`
        CreateTime string `json:"create_time"`
        Token      string `json:"token"`
        AppID      string `json:"app_id"`
        TenantKey  string `json:"tenant_key"`
    } `json:"header"`
    Event map[string]interface{} `json:"event"`
}

// é£ä¹¦Webhookç›‘å¬å™¨
type FeishuWebhookListener struct {
    syncer   *FeishuDocumentSyncer
    notifier *FeishuNotifier
    server   *gin.Engine
}

func NewFeishuWebhookListener(syncer *FeishuDocumentSyncer, notifier *FeishuNotifier) *FeishuWebhookListener {
    listener := &FeishuWebhookListener{
        syncer:   syncer,
        notifier: notifier,
        server:   gin.Default(),
    }
    
    // è®¾ç½®è·¯ç”±
    listener.setupRoutes()
    
    return listener
}

func (l *FeishuWebhookListener) setupRoutes() {
    l.server.POST("/webhook/feishu", l.handleWebhook)
}

func (l *FeishuWebhookListener) handleWebhook(c *gin.Context) {
    var event FeishuEvent
    if err := c.ShouldBindJSON(&event); err != nil {
        log.Printf("è§£æwebhookæ•°æ®å¤±è´¥: %v", err)
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }
    
    // éªŒè¯äº‹ä»¶åˆæ³•æ€§
    if !l.validateEvent(&event) {
        log.Printf("äº‹ä»¶éªŒè¯å¤±è´¥: %s", event.Header.EventID)
        c.JSON(http.StatusUnauthorized, gin.H{"error": "invalid event"})
        return
    }
    
    // å¤„ç†æ–‡æ¡£äº‹ä»¶
    go l.handleDocumentEvent(context.Background(), &event)
    
    c.JSON(http.StatusOK, gin.H{"challenge": event.Event["challenge"]})
}

func (l *FeishuWebhookListener) handleDocumentEvent(ctx context.Context, event *FeishuEvent) {
    switch event.Header.EventType {
    case "drive.file.edit_v1", "drive.file.title_updated_v1":
        l.handleDocumentUpdate(ctx, event)
    case "drive.file.created_in_folder_v1":
        l.handleDocumentCreate(ctx, event)
    case "drive.file.trashed_v1":
        l.handleDocumentDelete(ctx, event)
    default:
        log.Printf("æœªå¤„ç†çš„äº‹ä»¶ç±»å‹: %s", event.Header.EventType)
    }
}

func (l *FeishuWebhookListener) handleDocumentUpdate(ctx context.Context, event *FeishuEvent) {
    docToken, ok := event.Event["file_token"].(string)
    if !ok {
        log.Printf("æ— æ•ˆçš„æ–‡æ¡£token")
        return
    }
    
    docType, _ := event.Event["file_type"].(string)
    
    // é‡æ–°åŒæ­¥æ–‡æ¡£
    doc := &DocumentInfo{
        Token: docToken,
        Type:  docType,
    }
    
    if err := l.syncer.syncSingleDocument(ctx, doc); err != nil {
        log.Printf("åŒæ­¥æ–‡æ¡£å¤±è´¥ %s: %v", docToken, err)
        return
    }
    
    // å‘é€æ›´æ–°é€šçŸ¥
    l.sendUpdateNotification(event)
}

func (l *FeishuWebhookListener) handleDocumentCreate(ctx context.Context, event *FeishuEvent) {
    // å¤„ç†æ–°æ–‡æ¡£åˆ›å»º
    l.handleDocumentUpdate(ctx, event)
}

func (l *FeishuWebhookListener) handleDocumentDelete(ctx context.Context, event *FeishuEvent) {
    docToken, ok := event.Event["file_token"].(string)
    if !ok {
        return
    }
    
    // ä»å‘é‡åº“ä¸­åˆ é™¤ç›¸å…³æ–‡æ¡£
    // è¿™é‡Œéœ€è¦å®ç°åˆ é™¤é€»è¾‘
    log.Printf("æ–‡æ¡£å·²åˆ é™¤: %s", docToken)
}

func (l *FeishuWebhookListener) sendUpdateNotification(event *FeishuEvent) {
    docInfo := map[string]interface{}{
        "title":       event.Event["file_name"],
        "update_time": time.Now().Format("2006-01-02 15:04:05"),
        "operator":    event.Event["operator_id"],
        "doc_token":   event.Event["file_token"],
        "doc_url":     fmt.Sprintf("https://bytedance.feishu.cn/docs/%s", event.Event["file_token"]),
    }
    
    l.notifier.SendDocumentUpdateNotification(docInfo)
}

func (l *FeishuWebhookListener) Start(addr string) error {
    log.Printf("å¯åŠ¨Webhookç›‘å¬å™¨ï¼Œåœ°å€: %s", addr)
    return l.server.Run(addr)
}

// æƒé™åŒæ­¥å™¨
type FeishuPermissionSyncer struct {
    client *FeishuDocClient
}

func NewFeishuPermissionSyncer(client *FeishuDocClient) *FeishuPermissionSyncer {
    return &FeishuPermissionSyncer{
        client: client,
    }
}

type DocumentPermission struct {
    DocToken  string    `json:"doc_token"`
    Viewers   []string  `json:"viewers"`
    Editors   []string  `json:"editors"`
    Owners    []string  `json:"owners"`
    UpdatedAt time.Time `json:"updated_at"`
}

func (s *FeishuPermissionSyncer) SyncDocumentPermissions(ctx context.Context, docToken string) (*DocumentPermission, error) {
    permissions, err := s.client.getDocumentPermissions(ctx, docToken)
    if err != nil {
        return nil, fmt.Errorf("è·å–æ–‡æ¡£æƒé™å¤±è´¥: %w", err)
    }
    
    permissionCache := &DocumentPermission{
        DocToken:  docToken,
        Viewers:   permissions["viewers"].([]string),
        Editors:   permissions["editors"].([]string),
        Owners:    permissions["owners"].([]string),
        UpdatedAt: time.Now(),
    }
    
    // ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
    if err := s.savePermissionCache(permissionCache); err != nil {
        log.Printf("ä¿å­˜æƒé™ç¼“å­˜å¤±è´¥: %v", err)
    }
    
    return permissionCache, nil
}

func (s *FeishuPermissionSyncer) savePermissionCache(permission *DocumentPermission) error {
    // å®ç°æƒé™ç¼“å­˜ä¿å­˜é€»è¾‘
    // å¯ä»¥ä¿å­˜åˆ° Redis æˆ–æ•°æ®åº“ä¸­
    return nil
}
```

---

## ğŸ› ï¸ å®æ–½æ–¹æ¡ˆ

### Phase 1: æ ¸å¿ƒåŠŸèƒ½å¼€å‘ï¼ˆ4å‘¨ï¼‰

**Week 1-2: åŸºç¡€æ¶æ„æ­å»º**
- [x] Einoç¯å¢ƒé…ç½®
- [x] Milvuså‘é‡æ•°æ®åº“éƒ¨ç½²
- [x] æ–‡æ¡£å¤„ç†æµæ°´çº¿å¼€å‘
- [x] åŸºç¡€Webç•Œé¢

**Week 3-4: æ™ºèƒ½æ£€ç´¢åŠŸèƒ½**
- [x] RAGæ£€ç´¢é“¾å®ç°
- [x] å¤šæ¨¡æ€æ–‡æ¡£è§£æ
- [x] åŸºç¡€é—®ç­”åŠŸèƒ½
- [x] æ£€ç´¢ç»“æœä¼˜åŒ–

### Phase 2: é«˜çº§åŠŸèƒ½å¼€å‘ï¼ˆ3å‘¨ï¼‰

**Week 5-6: å®æ—¶æ›´æ–°æœºåˆ¶**
- [x] æ–‡ä»¶ç›‘æ§ç³»ç»Ÿ
- [x] å¢é‡æ›´æ–°é€»è¾‘
- [x] ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½

**Week 7: é£ä¹¦é›†æˆ**
- [x] é£ä¹¦æœºå™¨äººå¼€å‘
- [x] æ¶ˆæ¯æ¨é€åŠŸèƒ½
- [x] ç”¨æˆ·æƒé™ç®¡ç†

### Phase 3: ä¼˜åŒ–ä¸éƒ¨ç½²ï¼ˆ2å‘¨ï¼‰

**Week 8: ç³»ç»Ÿä¼˜åŒ–**
- [x] æ€§èƒ½è°ƒä¼˜
- [x] ç¼“å­˜ç­–ç•¥ä¼˜åŒ–
- [x] é”™è¯¯å¤„ç†å®Œå–„

**Week 9: ä¸Šçº¿éƒ¨ç½²**
- [x] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [x] ç”¨æˆ·åŸ¹è®­
- [x] è¿ç»´ç›‘æ§

---

## ğŸ’» æŠ€æœ¯å®ç°è¯¦è§£

### å®Œæ•´åº”ç”¨ç¤ºä¾‹

```go
package main

import (
    "context"
    "log"
    "os"
    "os/signal"
    "syscall"
    
    "github.com/gin-gonic/gin"
    "your-project/pkg/feishu"
    "your-project/pkg/pipeline"
    "your-project/pkg/retrieval"
    "your-project/pkg/webhook"
)

func main() {
    // è¯»å–é…ç½®
    config := loadConfig()
    
    // åˆå§‹åŒ–é£ä¹¦å®¢æˆ·ç«¯
    feishuClient := feishu.NewFeishuDocClient(
        config.Feishu.AppID,
        config.Feishu.AppSecret,
    )
    
    // åˆ›å»ºæ–‡æ¡£å¤„ç†æµæ°´çº¿
    docPipeline := pipeline.NewFeishuDocumentPipeline()
    
    // åˆ›å»ºæ–‡æ¡£åŒæ­¥å™¨
    syncer := feishu.NewFeishuDocumentSyncer(feishuClient, docPipeline)
    
    // åˆ›å»ºé—®ç­”ç³»ç»Ÿ
    qaSystem := retrieval.NewDocumentQASystem()
    
    // åˆ›å»ºé€šçŸ¥å™¨
    notifier := feishu.NewFeishuNotifier(config.Feishu.Bot.WebhookURL)
    
    // åˆ›å»ºWebhookç›‘å¬å™¨
    webhookListener := webhook.NewFeishuWebhookListener(syncer, notifier)
    
    // è®¾ç½®APIè·¯ç”±
    router := gin.Default()
    setupAPIRoutes(router, qaSystem)
    
    // å¯åŠ¨æœåŠ¡
    go func() {
        log.Println("å¯åŠ¨APIæœåŠ¡å™¨ :8080")
        if err := router.Run(":8080"); err != nil {
            log.Fatalf("APIæœåŠ¡å™¨å¯åŠ¨å¤±è´¥: %v", err)
        }
    }()
    
    go func() {
        log.Println("å¯åŠ¨Webhookç›‘å¬å™¨ :8081")
        if err := webhookListener.Start(":8081"); err != nil {
            log.Fatalf("Webhookç›‘å¬å™¨å¯åŠ¨å¤±è´¥: %v", err)
        }
    }()
    
    // é¦–æ¬¡å…¨é‡åŒæ­¥
    log.Println("å¼€å§‹å…¨é‡åŒæ­¥æ–‡æ¡£...")
    if err := syncer.SyncAllDocuments(context.Background()); err != nil {
        log.Printf("å…¨é‡åŒæ­¥å¤±è´¥: %v", err)
    } else {
        log.Println("å…¨é‡åŒæ­¥å®Œæˆ")
    }
    
    // è®¾ç½®Webhook
    if err := feishuClient.SetupWebhook(context.Background(), "http://your-domain.com:8081/webhook/feishu"); err != nil {
        log.Printf("è®¾ç½®Webhookå¤±è´¥: %v", err)
    }
    
    // ç­‰å¾…é€€å‡ºä¿¡å·
    quit := make(chan os.Signal, 1)
    signal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)
    <-quit
    
    log.Println("æœåŠ¡å™¨æ­£åœ¨å…³é—­...")
}

func setupAPIRoutes(router *gin.Engine, qaSystem *retrieval.DocumentQASystem) {
    api := router.Group("/api/v1")
    
    // æ–‡æ¡£é—®ç­”æ¥å£
    api.POST("/ask", func(c *gin.Context) {
        var request struct {
            Question string `json:"question" binding:"required"`
        }
        
        if err := c.ShouldBindJSON(&request); err != nil {
            c.JSON(400, gin.H{"error": err.Error()})
            return
        }
        
        answer, err := qaSystem.Ask(c.Request.Context(), request.Question)
        if err != nil {
            c.JSON(500, gin.H{"error": err.Error()})
            return
        }
        
        c.JSON(200, gin.H{
            "answer": answer,
            "timestamp": time.Now(),
        })
    })
    
    // å¥åº·æ£€æŸ¥æ¥å£
    api.GET("/health", func(c *gin.Context) {
        c.JSON(200, gin.H{"status": "ok"})
    })
}

type Config struct {
    Feishu struct {
        AppID     string `yaml:"app_id"`
        AppSecret string `yaml:"app_secret"`
        Bot       struct {
            WebhookURL string `yaml:"webhook_url"`
        } `yaml:"bot"`
    } `yaml:"feishu"`
}

func loadConfig() *Config {
    // å®ç°é…ç½®æ–‡ä»¶åŠ è½½é€»è¾‘
    return &Config{}
}
```

### é¡¹ç›®ç»“æ„

```
feishu-doc-ai/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ feishu/                     # é£ä¹¦APIé›†æˆ
â”‚   â”‚   â”œâ”€â”€ client.go              # é£ä¹¦APIå®¢æˆ·ç«¯  
â”‚   â”‚   â”œâ”€â”€ syncer.go              # æ–‡æ¡£åŒæ­¥å™¨
â”‚   â”‚   â””â”€â”€ notifier.go            # é£ä¹¦é€šçŸ¥å™¨
â”‚   â”œâ”€â”€ pipeline/                   # æ–‡æ¡£å¤„ç†æµæ°´çº¿
â”‚   â”‚   â”œâ”€â”€ processor.go           # æ–‡æ¡£å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ parser.go              # å†…å®¹è§£æå™¨
â”‚   â”œâ”€â”€ retrieval/                  # æ£€ç´¢å’Œé—®ç­”
â”‚   â”‚   â”œâ”€â”€ qa.go                  # é—®ç­”ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ analyzer.go            # æŸ¥è¯¢åˆ†æå™¨
â”‚   â”œâ”€â”€ webhook/                    # Webhookå¤„ç†
â”‚   â”‚   â”œâ”€â”€ listener.go            # äº‹ä»¶ç›‘å¬å™¨
â”‚   â”‚   â””â”€â”€ handler.go             # äº‹ä»¶å¤„ç†å™¨
â”‚   â””â”€â”€ config/                     # é…ç½®ç®¡ç†
â”‚       â””â”€â”€ config.go              # é…ç½®ç»“æ„ä½“
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ config.yaml                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile                  # Dockeræ„å»ºæ–‡ä»¶
â”‚   â””â”€â”€ docker-compose.yml         # å®¹å™¨ç¼–æ’
â”œâ”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ go.mod                          # Goæ¨¡å—æ–‡ä»¶
â””â”€â”€ go.sum                          # ä¾èµ–ç‰ˆæœ¬é”å®š
```

### Goä¾èµ–ç®¡ç†

```go
// go.mod
module feishu-doc-ai

go 1.21

require (
    github.com/cloudwego/eino v0.0.10
    github.com/gin-gonic/gin v1.9.1
    github.com/go-redis/redis/v8 v8.11.5
    github.com/milvus-io/milvus-sdk-go/v2 v2.3.1
    github.com/spf13/viper v1.16.0
    github.com/stretchr/testify v1.8.4
    gopkg.in/yaml.v3 v3.0.1
)
```

### æ ¸å¿ƒé…ç½®æ–‡ä»¶

```yaml
# configs/config.yaml
app:
  name: "é£ä¹¦æ–‡æ¡£AIåŠ©æ‰‹"
  version: "1.0.0"
  host: "0.0.0.0"
  port: 8080
  webhook_port: 8081

# é£ä¹¦é…ç½® (å·²åœ¨å‰é¢æä¾›)
feishu:
  app_id: "${FEISHU_APP_ID}"
  app_secret: "${FEISHU_APP_SECRET}"
  # ... (å…¶ä»–é…ç½®)

# Einoæ¡†æ¶é…ç½®
eino:
  models:
    embedding:
      provider: "openai"
      model: "text-embedding-ada-002"
    chat:
      provider: "openai" 
      model: "gpt-4"
      
  # Milvuså‘é‡æ•°æ®åº“
  milvus:
    host: "localhost"
    port: 19530
    collection: "feishu_docs"
    dimension: 1536
    
  # æ–‡æ¡£å¤„ç†é…ç½®
  document:
    chunk_size: 512
    chunk_overlap: 50
    batch_size: 100
```

---

## ğŸ—ï¸ è¯¦ç»†ç³»ç»Ÿè®¾è®¡

### 26. ç³»ç»Ÿæ¶æ„å›¾

#### æ•´ä½“æ¶æ„æ¦‚è§ˆ
```
                    ğŸŒ Internet
                         â”‚
                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
                    â”‚  Nginx  â”‚ (è´Ÿè½½å‡è¡¡ + SSL)
                    â”‚ Gateway â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚                â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚API æœåŠ¡1â”‚     â”‚API æœåŠ¡2â”‚     â”‚API æœåŠ¡3â”‚
   â”‚:8080    â”‚     â”‚:8080    â”‚     â”‚:8080    â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚                â”‚                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
       â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
       â”‚Webhook  â”‚              â”‚å®šæ—¶ä»»åŠ¡  â”‚
       â”‚ç›‘å¬å™¨   â”‚              â”‚è°ƒåº¦å™¨   â”‚
       â”‚:8081    â”‚              â”‚Cron     â”‚
       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
            â”‚                        â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             Eino å¤„ç†å¼•æ“               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Document        â”‚ Embedding           â”‚
    â”‚ Processor       â”‚ Generator           â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Content         â”‚ Vector              â”‚
    â”‚ Splitter        â”‚ Indexer             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚                â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚ Milvus  â”‚     â”‚ MySQL   â”‚     â”‚ Redis   â”‚
   â”‚å‘é‡æ•°æ®åº“â”‚     â”‚å…ƒæ•°æ®åº“  â”‚     â”‚ç¼“å­˜å±‚   â”‚
   â”‚:19530   â”‚     â”‚:3306    â”‚     â”‚:6379    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                     â”‚
               â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
               â”‚é£ä¹¦API   â”‚                          â”‚OpenAI   â”‚
               â”‚é›†æˆå±‚    â”‚                          â”‚API      â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ•°æ®æµæ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP/HTTPS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯åº”ç”¨   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  APIç½‘å…³    â”‚
â”‚ React/Vue   â”‚                  â”‚   Nginx     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  ä¸šåŠ¡æœåŠ¡å±‚  â”‚
                                â”‚  Go Server  â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚                  â”‚
                    â–¼                  â–¼                  â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  æ•°æ®å¤„ç†å±‚  â”‚    â”‚   å­˜å‚¨å±‚    â”‚    â”‚  å¤–éƒ¨æœåŠ¡å±‚  â”‚
            â”‚ Eino Engine â”‚    â”‚MySQL/Milvusâ”‚    â”‚é£ä¹¦/OpenAI  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 27. æ•°æ®åº“Schemaè®¾è®¡

#### MySQL å…ƒæ•°æ®å­˜å‚¨
```sql
-- æ–‡æ¡£ä¿¡æ¯è¡¨
CREATE TABLE documents (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    doc_token VARCHAR(64) NOT NULL UNIQUE COMMENT 'é£ä¹¦æ–‡æ¡£token',
    doc_type ENUM('doc', 'sheet', 'bitable', 'wiki') NOT NULL COMMENT 'æ–‡æ¡£ç±»å‹',
    title VARCHAR(512) NOT NULL COMMENT 'æ–‡æ¡£æ ‡é¢˜',
    url VARCHAR(1024) NOT NULL COMMENT 'æ–‡æ¡£é“¾æ¥',
    owner_id VARCHAR(64) NOT NULL COMMENT 'æ–‡æ¡£æ‰€æœ‰è€…ID',
    owner_name VARCHAR(128) NOT NULL COMMENT 'æ–‡æ¡£æ‰€æœ‰è€…å§“å',
    folder_token VARCHAR(64) COMMENT 'æ‰€å±æ–‡ä»¶å¤¹token',
    content_hash VARCHAR(64) COMMENT 'å†…å®¹hashï¼Œç”¨äºæ£€æµ‹å˜æ›´',
    word_count INT DEFAULT 0 COMMENT 'æ–‡æ¡£å­—æ•°',
    chunk_count INT DEFAULT 0 COMMENT 'åˆ†å—æ•°é‡',
    status ENUM('active', 'deleted', 'processing', 'failed') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    synced_at TIMESTAMP NULL COMMENT 'æœ€ååŒæ­¥æ—¶é—´',
    
    INDEX idx_doc_token (doc_token),
    INDEX idx_doc_type (doc_type),
    INDEX idx_owner_id (owner_id),
    INDEX idx_updated_at (updated_at),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æ–‡æ¡£åŸºæœ¬ä¿¡æ¯è¡¨';

-- æ–‡æ¡£å†…å®¹å—è¡¨
CREATE TABLE document_chunks (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    document_id BIGINT NOT NULL COMMENT 'æ–‡æ¡£ID',
    chunk_index INT NOT NULL COMMENT 'å—åºå·',
    content TEXT NOT NULL COMMENT 'æ–‡æœ¬å†…å®¹',
    content_type ENUM('text', 'table', 'image', 'code') DEFAULT 'text',
    char_count INT NOT NULL DEFAULT 0,
    vector_id VARCHAR(64) COMMENT 'Milvusä¸­çš„å‘é‡ID',
    metadata JSON COMMENT 'é¢å¤–å…ƒæ•°æ®',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (document_id) REFERENCES documents(id) ON DELETE CASCADE,
    INDEX idx_document_id (document_id),
    INDEX idx_vector_id (vector_id),
    UNIQUE KEY uk_doc_chunk (document_id, chunk_index)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æ–‡æ¡£å†…å®¹åˆ†å—è¡¨';

-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    feishu_user_id VARCHAR(64) NOT NULL UNIQUE COMMENT 'é£ä¹¦ç”¨æˆ·ID',
    name VARCHAR(128) NOT NULL COMMENT 'ç”¨æˆ·å§“å',
    avatar_url VARCHAR(512) COMMENT 'å¤´åƒé“¾æ¥',
    email VARCHAR(256) COMMENT 'é‚®ç®±',
    department VARCHAR(256) COMMENT 'éƒ¨é—¨',
    role ENUM('admin', 'user', 'guest') DEFAULT 'user',
    status ENUM('active', 'inactive') DEFAULT 'active',
    last_login_at TIMESTAMP NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_feishu_user_id (feishu_user_id),
    INDEX idx_email (email),
    INDEX idx_role (role)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·ä¿¡æ¯è¡¨';

-- æ–‡æ¡£æƒé™è¡¨
CREATE TABLE document_permissions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    document_id BIGINT NOT NULL,
    user_id BIGINT NOT NULL,
    permission ENUM('owner', 'editor', 'viewer') NOT NULL,
    granted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    granted_by BIGINT COMMENT 'æˆæƒè€…ID',
    
    FOREIGN KEY (document_id) REFERENCES documents(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY uk_doc_user (document_id, user_id),
    INDEX idx_user_id (user_id),
    INDEX idx_permission (permission)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æ–‡æ¡£æƒé™è¡¨';

-- é—®ç­”è®°å½•è¡¨
CREATE TABLE qa_sessions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    session_id VARCHAR(64) NOT NULL COMMENT 'ä¼šè¯ID',
    user_id BIGINT NOT NULL,
    question TEXT NOT NULL,
    answer TEXT,
    context_docs JSON COMMENT 'å‚è€ƒçš„æ–‡æ¡£åˆ—è¡¨',
    satisfaction_score TINYINT COMMENT 'æ»¡æ„åº¦è¯„åˆ† 1-5',
    response_time_ms INT COMMENT 'å“åº”æ—¶é—´(æ¯«ç§’)',
    model_used VARCHAR(64) COMMENT 'ä½¿ç”¨çš„AIæ¨¡å‹',
    tokens_used INT COMMENT 'æ¶ˆè€—çš„tokenæ•°',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id),
    INDEX idx_session_id (session_id),
    INDEX idx_user_id (user_id),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—®ç­”è®°å½•è¡¨';

-- ç³»ç»Ÿé…ç½®è¡¨
CREATE TABLE system_configs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    config_key VARCHAR(128) NOT NULL UNIQUE,
    config_value TEXT NOT NULL,
    config_type ENUM('string', 'int', 'float', 'bool', 'json') DEFAULT 'string',
    description VARCHAR(512),
    updated_by BIGINT,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_config_key (config_key)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç³»ç»Ÿé…ç½®è¡¨';

-- åŒæ­¥æ—¥å¿—è¡¨
CREATE TABLE sync_logs (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sync_type ENUM('full', 'incremental', 'single') NOT NULL,
    document_id BIGINT COMMENT 'å•æ–‡æ¡£åŒæ­¥æ—¶çš„æ–‡æ¡£ID',
    status ENUM('running', 'success', 'failed') NOT NULL,
    total_docs INT DEFAULT 0,
    processed_docs INT DEFAULT 0,
    failed_docs INT DEFAULT 0,
    error_message TEXT,
    started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP NULL,
    
    INDEX idx_sync_type (sync_type),
    INDEX idx_status (status),
    INDEX idx_started_at (started_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='åŒæ­¥æ—¥å¿—è¡¨';
```

#### Milvus å‘é‡æ•°æ®åº“Schema
```go
// Milvus Collection Schema
type DocumentVector struct {
    ID          int64     `milvus:"id,primary_key,auto_id"`           // ä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆ
    DocumentID  int64     `milvus:"document_id"`                      // æ–‡æ¡£IDï¼Œå¯¹åº”MySQL
    ChunkIndex  int32     `milvus:"chunk_index"`                      // å—ç´¢å¼•
    Vector      []float32 `milvus:"vector,dim:1536"`                 // 1536ç»´å‘é‡
    ContentHash string    `milvus:"content_hash,varchar:64"`         // å†…å®¹hash
    DocType     string    `milvus:"doc_type,varchar:16"`             // æ–‡æ¡£ç±»å‹
    UpdateTime  int64     `milvus:"update_time"`                     // æ›´æ–°æ—¶é—´æˆ³
}

// åˆ›å»ºCollectionçš„å‚æ•°
CollectionSchema: {
    Name: "feishu_docs",
    Fields: [
        {Name: "id", DataType: Int64, PrimaryKey: true, AutoID: true},
        {Name: "document_id", DataType: Int64},
        {Name: "chunk_index", DataType: Int32},
        {Name: "vector", DataType: FloatVector, Dim: 1536},
        {Name: "content_hash", DataType: VarChar, MaxLength: 64},
        {Name: "doc_type", DataType: VarChar, MaxLength: 16},
        {Name: "update_time", DataType: Int64},
    ],
    Indexes: [
        {FieldName: "vector", IndexType: "IVF_FLAT", MetricType: "L2", Params: {"nlist": 1024}},
        {FieldName: "document_id", IndexType: "STL_SORT"},
        {FieldName: "doc_type", IndexType: "STL_SORT"},
    ]
}
```

### 28. APIæ¥å£è®¾è®¡

#### RESTful APIè§„èŒƒ
```go
// API Base URL: https://doc-ai.yourcompany.com/api/v1

// 1. è®¤è¯ç›¸å…³æ¥å£
type AuthAPI struct{}

// POST /api/v1/auth/login - ç”¨æˆ·ç™»å½•
type LoginRequest struct {
    Code string `json:"code" binding:"required"` // é£ä¹¦æˆæƒç 
}

type LoginResponse struct {
    Token     string    `json:"token"`
    ExpiresAt time.Time `json:"expires_at"`
    User      UserInfo  `json:"user"`
}

// GET /api/v1/auth/profile - è·å–ç”¨æˆ·ä¿¡æ¯
type UserInfo struct {
    ID         int64  `json:"id"`
    Name       string `json:"name"`
    Avatar     string `json:"avatar"`
    Email      string `json:"email"`
    Department string `json:"department"`
    Role       string `json:"role"`
}

// 2. æ–‡æ¡£ç›¸å…³æ¥å£
type DocumentAPI struct{}

// GET /api/v1/documents - è·å–æ–‡æ¡£åˆ—è¡¨
type GetDocumentsRequest struct {
    Page     int    `form:"page,default=1"`
    PageSize int    `form:"page_size,default=20"`
    Type     string `form:"type"`        // æ–‡æ¡£ç±»å‹è¿‡æ»¤
    Owner    string `form:"owner"`       // æ‰€æœ‰è€…è¿‡æ»¤
    Keyword  string `form:"keyword"`     // å…³é”®è¯æœç´¢
    StartDate string `form:"start_date"` // å¼€å§‹æ—¥æœŸ
    EndDate   string `form:"end_date"`   // ç»“æŸæ—¥æœŸ
}

type GetDocumentsResponse struct {
    Documents []DocumentInfo `json:"documents"`
    Total     int64          `json:"total"`
    Page      int            `json:"page"`
    PageSize  int            `json:"page_size"`
}

type DocumentInfo struct {
    ID          int64     `json:"id"`
    DocToken    string    `json:"doc_token"`
    Type        string    `json:"type"`
    Title       string    `json:"title"`
    URL         string    `json:"url"`
    Owner       string    `json:"owner"`
    WordCount   int       `json:"word_count"`
    ChunkCount  int       `json:"chunk_count"`
    Status      string    `json:"status"`
    CreatedAt   time.Time `json:"created_at"`
    UpdatedAt   time.Time `json:"updated_at"`
    SyncedAt    *time.Time `json:"synced_at"`
}

// POST /api/v1/documents/sync - æ‰‹åŠ¨åŒæ­¥æ–‡æ¡£
type SyncDocumentsRequest struct {
    DocTokens []string `json:"doc_tokens"` // æŒ‡å®šæ–‡æ¡£ï¼Œç©ºåˆ™å…¨é‡åŒæ­¥
    Force     bool     `json:"force"`      // å¼ºåˆ¶é‡æ–°åŒæ­¥
}

type SyncDocumentsResponse struct {
    TaskID string `json:"task_id"`
    Status string `json:"status"`
}

// 3. é—®ç­”ç›¸å…³æ¥å£
type QAAPI struct{}

// POST /api/v1/qa/ask - æé—®æ¥å£
type AskRequest struct {
    Question   string            `json:"question" binding:"required"`
    SessionID  string            `json:"session_id"`
    Context    map[string]interface{} `json:"context"`
    Filters    map[string]interface{} `json:"filters"` // æ–‡æ¡£ç±»å‹ã€æ—¶é—´èŒƒå›´ç­‰è¿‡æ»¤
}

type AskResponse struct {
    Answer       string           `json:"answer"`
    SessionID    string           `json:"session_id"`
    Sources      []SourceDocument `json:"sources"`      // å‚è€ƒæ–‡æ¡£
    Confidence   float64          `json:"confidence"`   // ç½®ä¿¡åº¦
    ResponseTime int              `json:"response_time"` // å“åº”æ—¶é—´ms
    TokensUsed   int              `json:"tokens_used"`   // tokenæ¶ˆè€—
}

type SourceDocument struct {
    DocID     int64   `json:"doc_id"`
    Title     string  `json:"title"`
    URL       string  `json:"url"`
    Excerpt   string  `json:"excerpt"`   // ç›¸å…³ç‰‡æ®µ
    Score     float64 `json:"score"`     // ç›¸å…³åº¦åˆ†æ•°
    ChunkIndex int    `json:"chunk_index"`
}

// GET /api/v1/qa/sessions/{session_id}/history - è·å–å¯¹è¯å†å²
type GetHistoryResponse struct {
    SessionID string    `json:"session_id"`
    Messages  []Message `json:"messages"`
}

type Message struct {
    Type      string    `json:"type"`      // "question" | "answer"
    Content   string    `json:"content"`
    Timestamp time.Time `json:"timestamp"`
    Sources   []SourceDocument `json:"sources,omitempty"`
}

// POST /api/v1/qa/feedback - åé¦ˆè¯„ä»·
type FeedbackRequest struct {
    SessionID string `json:"session_id" binding:"required"`
    MessageID string `json:"message_id" binding:"required"`
    Score     int    `json:"score" binding:"required,min=1,max=5"` // 1-5åˆ†
    Comment   string `json:"comment"`
}

// 4. ç»Ÿè®¡åˆ†ææ¥å£
type AnalyticsAPI struct{}

// GET /api/v1/analytics/dashboard - ä»ªè¡¨æ¿æ•°æ®
type DashboardResponse struct {
    DocumentStats DocumentStats `json:"document_stats"`
    QAStats       QAStats       `json:"qa_stats"`
    UserStats     UserStats     `json:"user_stats"`
    SyncStats     SyncStats     `json:"sync_stats"`
}

type DocumentStats struct {
    TotalDocs     int64 `json:"total_docs"`
    DocsToday     int64 `json:"docs_today"`
    DocsThisWeek  int64 `json:"docs_this_week"`
    DocsThisMonth int64 `json:"docs_this_month"`
    TypeDistribution map[string]int64 `json:"type_distribution"`
}

type QAStats struct {
    TotalQuestions int64   `json:"total_questions"`
    QuestionsToday int64   `json:"questions_today"`
    AvgResponseTime int    `json:"avg_response_time"`
    AvgSatisfaction float64 `json:"avg_satisfaction"`
    PopularQuestions []string `json:"popular_questions"`
}

// 5. ç®¡ç†å‘˜æ¥å£
type AdminAPI struct{}

// GET /api/v1/admin/sync/logs - è·å–åŒæ­¥æ—¥å¿—
type GetSyncLogsResponse struct {
    Logs []SyncLog `json:"logs"`
    Total int64    `json:"total"`
}

type SyncLog struct {
    ID            int64     `json:"id"`
    SyncType      string    `json:"sync_type"`
    Status        string    `json:"status"`
    TotalDocs     int       `json:"total_docs"`
    ProcessedDocs int       `json:"processed_docs"`
    FailedDocs    int       `json:"failed_docs"`
    ErrorMessage  string    `json:"error_message,omitempty"`
    StartedAt     time.Time `json:"started_at"`
    CompletedAt   *time.Time `json:"completed_at"`
}

// POST /api/v1/admin/config - æ›´æ–°ç³»ç»Ÿé…ç½®
type UpdateConfigRequest struct {
    Configs map[string]interface{} `json:"configs"`
}
```

### 29. å‰ç«¯ç»„ä»¶ç»“æ„

#### React/TypeScript ç»„ä»¶æ¶æ„
```typescript
// é¡¹ç›®ç»“æ„
src/
â”œâ”€â”€ components/          // é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”œâ”€â”€ Loading.tsx
â”‚   â”‚   â”œâ”€â”€ Toast.tsx
â”‚   â”‚   â””â”€â”€ ErrorBoundary.tsx
â”‚   â”œâ”€â”€ forms/
â”‚   â”‚   â”œâ”€â”€ SearchBox.tsx
â”‚   â”‚   â”œâ”€â”€ FilterPanel.tsx
â”‚   â”‚   â””â”€â”€ DateRangePicker.tsx
â”‚   â””â”€â”€ charts/
â”‚       â”œâ”€â”€ DocumentChart.tsx
â”‚       â””â”€â”€ UsageChart.tsx
â”œâ”€â”€ pages/               // é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ DocumentStats.tsx
â”‚   â”‚   â””â”€â”€ QAStats.tsx
â”‚   â”œâ”€â”€ Chat/
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ ChatWindow.tsx
â”‚   â”‚   â”œâ”€â”€ MessageList.tsx
â”‚   â”‚   â”œâ”€â”€ MessageItem.tsx
â”‚   â”‚   â”œâ”€â”€ InputBox.tsx
â”‚   â”‚   â””â”€â”€ SourcePanel.tsx
â”‚   â”œâ”€â”€ Documents/
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ DocumentList.tsx
â”‚   â”‚   â”œâ”€â”€ DocumentCard.tsx
â”‚   â”‚   â””â”€â”€ DocumentDetail.tsx
â”‚   â””â”€â”€ Admin/
â”‚       â”œâ”€â”€ index.tsx
â”‚       â”œâ”€â”€ SyncManager.tsx
â”‚       â”œâ”€â”€ UserManager.tsx
â”‚       â””â”€â”€ ConfigManager.tsx
â”œâ”€â”€ hooks/               // è‡ªå®šä¹‰Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useChat.ts
â”‚   â”œâ”€â”€ useDocuments.ts
â”‚   â””â”€â”€ useWebSocket.ts
â”œâ”€â”€ services/            // APIæœåŠ¡å±‚
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ chat.ts
â”‚   â””â”€â”€ documents.ts
â”œâ”€â”€ store/               // çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ authSlice.ts
â”‚   â”œâ”€â”€ chatSlice.ts
â”‚   â””â”€â”€ documentsSlice.ts
â”œâ”€â”€ types/               // ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ chat.ts
â”‚   â””â”€â”€ document.ts
â”œâ”€â”€ utils/               // å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ request.ts
â”‚   â”œâ”€â”€ format.ts
â”‚   â””â”€â”€ constants.ts
â””â”€â”€ styles/              // æ ·å¼æ–‡ä»¶
    â”œâ”€â”€ globals.css
    â”œâ”€â”€ components.css
    â””â”€â”€ variables.css
```

#### æ ¸å¿ƒç»„ä»¶å®ç°
```typescript
// 1. ä¸»èŠå¤©ç»„ä»¶
interface ChatWindowProps {
  sessionId?: string;
  onNewSession: (sessionId: string) => void;
}

const ChatWindow: React.FC<ChatWindowProps> = ({ sessionId, onNewSession }) => {
  const [messages, setMessages] = useState<Message[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const { sendMessage, history } = useChat(sessionId);

  const handleSendMessage = async (question: string) => {
    setIsLoading(true);
    try {
      const response = await sendMessage(question);
      setMessages(prev => [...prev, 
        { type: 'question', content: question, timestamp: new Date() },
        { type: 'answer', content: response.answer, sources: response.sources, timestamp: new Date() }
      ]);
    } catch (error) {
      // é”™è¯¯å¤„ç†
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="chat-window">
      <MessageList messages={messages} />
      <InputBox onSend={handleSendMessage} disabled={isLoading} />
      {isLoading && <Loading />}
    </div>
  );
};

// 2. æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶
const MessageList: React.FC<{ messages: Message[] }> = ({ messages }) => {
  return (
    <div className="message-list">
      {messages.map((message, index) => (
        <MessageItem 
          key={index} 
          message={message}
          showSources={message.type === 'answer'}
        />
      ))}
    </div>
  );
};

// 3. æ–‡æ¡£æœç´¢ç»„ä»¶
const DocumentSearch: React.FC = () => {
  const [filters, setFilters] = useState<DocumentFilters>({});
  const { documents, loading, searchDocuments } = useDocuments();

  return (
    <div className="document-search">
      <SearchBox onSearch={searchDocuments} />
      <FilterPanel filters={filters} onChange={setFilters} />
      <DocumentList documents={documents} loading={loading} />
    </div>
  );
};

// 4. ä»ªè¡¨æ¿ç»„ä»¶
const Dashboard: React.FC = () => {
  const { stats, loading } = useDashboardStats();

  if (loading) return <Loading />;

  return (
    <div className="dashboard">
      <div className="stats-grid">
        <DocumentStats stats={stats.documentStats} />
        <QAStats stats={stats.qaStats} />
        <UserStats stats={stats.userStats} />
        <SyncStats stats={stats.syncStats} />
      </div>
      <div className="charts-section">
        <DocumentChart data={stats.documentTrends} />
        <UsageChart data={stats.usageTrends} />
      </div>
    </div>
  );
};

// 5. è‡ªå®šä¹‰Hooks
const useChat = (sessionId?: string) => {
  const [history, setHistory] = useState<Message[]>([]);
  
  const sendMessage = async (question: string) => {
    const response = await fetch('/api/v1/qa/ask', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ question, session_id: sessionId })
    });
    return response.json();
  };

  const loadHistory = async () => {
    if (sessionId) {
      const response = await fetch(`/api/v1/qa/sessions/${sessionId}/history`);
      const data = await response.json();
      setHistory(data.messages);
    }
  };

  useEffect(() => {
    loadHistory();
  }, [sessionId]);

  return { sendMessage, history, loadHistory };
};
```

### 30. éƒ¨ç½²æ¶æ„

#### å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ
```yaml
# docker-compose.yml
version: '3.8'

services:
  # Nginx ç½‘å…³
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./nginx/ssl:/etc/nginx/ssl
      - ./nginx/logs:/var/log/nginx
    depends_on:
      - api-server
      - web-app
    networks:
      - feishu-network

  # APIæœåŠ¡ (å¤šå®ä¾‹)
  api-server:
    build:
      context: .
      dockerfile: docker/Dockerfile.api
    environment:
      - GO_ENV=production
      - MYSQL_HOST=mysql
      - REDIS_HOST=redis
      - MILVUS_HOST=milvus-standalone
    volumes:
      - ./configs:/app/configs
      - ./logs:/app/logs
    depends_on:
      - mysql
      - redis
      - milvus-standalone
    deploy:
      replicas: 3
    networks:
      - feishu-network

  # Webå‰ç«¯
  web-app:
    build:
      context: ./web
      dockerfile: Dockerfile
    environment:
      - NODE_ENV=production
      - REACT_APP_API_BASE_URL=https://doc-ai.yourcompany.com/api
    networks:
      - feishu-network

  # MySQLæ•°æ®åº“
  mysql:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
      - MYSQL_DATABASE=feishu_doc_ai
      - MYSQL_USER=app_user
      - MYSQL_PASSWORD=${MYSQL_PASSWORD}
    volumes:
      - mysql-data:/var/lib/mysql
      - ./database/init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - "3306:3306"
    networks:
      - feishu-network

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis-data:/data
    ports:
      - "6379:6379"
    networks:
      - feishu-network

  # Milvuså‘é‡æ•°æ®åº“
  etcd:
    container_name: milvus-etcd
    image: quay.io/coreos/etcd:v3.5.0
    environment:
      - ETCD_AUTO_COMPACTION_MODE=revision
      - ETCD_AUTO_COMPACTION_RETENTION=1000
      - ETCD_QUOTA_BACKEND_BYTES=4294967296
    volumes:
      - etcd-data:/etcd
    command: etcd -advertise-client-urls=http://127.0.0.1:2379 -listen-client-urls http://0.0.0.0:2379 --data-dir /etcd
    networks:
      - feishu-network

  minio:
    container_name: milvus-minio
    image: minio/minio:RELEASE.2022-03-17T06-34-49Z
    environment:
      MINIO_ACCESS_KEY: minioadmin
      MINIO_SECRET_KEY: minioadmin
    volumes:
      - minio-data:/data
    command: minio server /data
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]
      interval: 30s
      timeout: 20s
      retries: 3
    networks:
      - feishu-network

  milvus-standalone:
    container_name: milvus-standalone
    image: milvusdb/milvus:v2.3.1
    command: ["milvus", "run", "standalone"]
    environment:
      ETCD_ENDPOINTS: etcd:2379
      MINIO_ADDRESS: minio:9000
    volumes:
      - milvus-data:/var/lib/milvus
    ports:
      - "19530:19530"
      - "9091:9091"
    depends_on:
      - "etcd"
      - "minio"
    networks:
      - feishu-network

  # ç›‘æ§æœåŠ¡
  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus-data:/prometheus
    networks:
      - feishu-network

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=${GRAFANA_PASSWORD}
    volumes:
      - grafana-data:/var/lib/grafana
      - ./monitoring/grafana:/etc/grafana/provisioning
    networks:
      - feishu-network

volumes:
  mysql-data:
  redis-data:
  milvus-data:
  etcd-data:
  minio-data:
  prometheus-data:
  grafana-data:

networks:
  feishu-network:
    driver: bridge
```

#### Kuberneteséƒ¨ç½²é…ç½®
```yaml
# k8s/namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: feishu-doc-ai

---
# k8s/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: feishu-doc-ai
data:
  config.yaml: |
    app:
      name: "é£ä¹¦æ–‡æ¡£AIåŠ©æ‰‹"
      port: 8080
    feishu:
      app_id: "${FEISHU_APP_ID}"
      app_secret: "${FEISHU_APP_SECRET}"
    # ... å…¶ä»–é…ç½®

---
# k8s/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secret
  namespace: feishu-doc-ai
type: Opaque
data:
  mysql-password: <base64-encoded-password>
  redis-password: <base64-encoded-password>
  openai-api-key: <base64-encoded-key>

---
# k8s/api-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api-server
  namespace: feishu-doc-ai
spec:
  replicas: 3
  selector:
    matchLabels:
      app: api-server
  template:
    metadata:
      labels:
        app: api-server
    spec:
      containers:
      - name: api-server
        image: feishu-doc-ai/api-server:latest
        ports:
        - containerPort: 8080
        - containerPort: 8081  # webhook port
        env:
        - name: MYSQL_PASSWORD
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: mysql-password
        - name: REDIS_PASSWORD
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: redis-password
        volumeMounts:
        - name: config-volume
          mountPath: /app/configs
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi" 
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /api/v1/health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /api/v1/health
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
      volumes:
      - name: config-volume
        configMap:
          name: app-config

---
# k8s/api-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: api-server-service
  namespace: feishu-doc-ai
spec:
  selector:
    app: api-server
  ports:
  - name: http
    port: 80
    targetPort: 8080
  - name: webhook
    port: 8081
    targetPort: 8081
  type: ClusterIP

---
# k8s/ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: app-ingress
  namespace: feishu-doc-ai
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
spec:
  tls:
  - hosts:
    - doc-ai.yourcompany.com
    secretName: app-tls
  rules:
  - host: doc-ai.yourcompany.com
    http:
      paths:
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: api-server-service
            port:
              number: 80
      - path: /
        pathType: Prefix
        backend:
          service:
            name: web-app-service
            port:
              number: 80

---
# k8s/hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: api-server-hpa
  namespace: feishu-doc-ai
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: api-server
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
```

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### åŸºç¡€è®¾æ–½éœ€æ±‚

**æœåŠ¡å™¨é…ç½®:**
- **CPU**: 4æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**: 16GBä»¥ä¸Š  
- **å­˜å‚¨**: 500GB SSD
- **ç½‘ç»œ**: 10Mbpsä»¥ä¸Šå¸¦å®½

**ä¾èµ–æœåŠ¡:**
```yaml
version: '3.8'
services:
  # Milvuså‘é‡æ•°æ®åº“
  milvus:
    image: milvusdb/milvus:latest
    ports:
      - "19530:19530"
    volumes:
      - milvus_data:/var/lib/milvus
    environment:
      - MILVUS_CONFIG_PATH=/milvus/configs/milvus.yaml
  
  # MySQLå…ƒæ•°æ®å­˜å‚¨
  mysql:
    image: mysql:8.0
    ports:
      - "3306:3306"
    environment:
      - MYSQL_ROOT_PASSWORD=your_password
      - MYSQL_DATABASE=document_ai
    volumes:
      - mysql_data:/var/lib/mysql
  
  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
  
  # åº”ç”¨ä¸»æœåŠ¡
  document-ai:
    build: .
    ports:
      - "8080:8080"
    depends_on:
      - milvus
      - mysql
      - redis
    environment:
      - MILVUS_HOST=milvus
      - MYSQL_HOST=mysql
      - REDIS_HOST=redis
    volumes:
      - ./documents:/app/documents
      - ./logs:/app/logs

volumes:
  milvus_data:
  mysql_data:
  redis_data:
```

### ç¯å¢ƒé…ç½®

**åº”ç”¨é…ç½®æ–‡ä»¶ (`config.yaml`):**
```yaml
# åº”ç”¨é…ç½®
app:
  name: "äº§å“æ–‡æ¡£AIåŠ©æ‰‹"
  version: "1.0.0"
  host: "0.0.0.0"
  port: 8080
  debug: false

# æ•°æ®åº“é…ç½®
database:
  milvus:
    host: "localhost"
    port: 19530
    collection_name: "product_docs"
    
  mysql:
    host: "localhost"
    port: 3306
    username: "root"
    password: "your_password"
    database: "document_ai"
    
  redis:
    host: "localhost"
    port: 6379
    password: ""
    db: 0

# AIæ¨¡å‹é…ç½®
models:
  embedding:
    provider: "openai"
    model: "text-embedding-ada-002"
    api_key: "${OPENAI_API_KEY}"
    
  chat:
    provider: "openai"
    model: "gpt-4"
    api_key: "${OPENAI_API_KEY}"
    temperature: 0.1
    max_tokens: 2000

# æ–‡æ¡£ç›‘æ§é…ç½®
monitoring:
  watch_paths:
    - "/data/product_docs"
    - "/data/requirements"
  file_types: [".docx", ".pdf", ".md", ".txt"]
  update_delay: 5  # ç§’

# é£ä¹¦é›†æˆé…ç½®
feishu:
  # é£ä¹¦åº”ç”¨é…ç½®
  app_id: "${FEISHU_APP_ID}"
  app_secret: "${FEISHU_APP_SECRET}"
  
  # APIé…ç½®
  api_base_url: "https://open.feishu.cn"
  
  # æœºå™¨äººé…ç½®
  bot:
    webhook_url: "${FEISHU_WEBHOOK_URL}"
    encrypt_key: "${FEISHU_ENCRYPT_KEY}"
    verification_token: "${FEISHU_VERIFICATION_TOKEN}"
  
  # æ–‡æ¡£åŒæ­¥é…ç½®
  sync:
    batch_size: 50  # æ‰¹é‡åŒæ­¥æ–‡æ¡£æ•°é‡
    rate_limit: 100  # æ¯åˆ†é’ŸAPIè°ƒç”¨é™åˆ¶
    retry_times: 3   # å¤±è´¥é‡è¯•æ¬¡æ•°
    sync_interval: 3600  # å…¨é‡åŒæ­¥é—´éš”(ç§’)
    
  # ç›‘å¬çš„æ–‡æ¡£æ–‡ä»¶å¤¹
  watch_folders:
    - "äº§å“éœ€æ±‚æ–‡æ¡£"
    - "æŠ€æœ¯è®¾è®¡æ–‡æ¡£" 
    - "é¡¹ç›®ç®¡ç†æ–‡æ¡£"
    - "ç”¨æˆ·ç ”ç©¶æŠ¥å‘Š"
  
  # Webhookäº‹ä»¶è®¢é˜…
  events:
    - "drive.file.created_in_folder_v1"
    - "drive.file.edit_v1"
    - "drive.file.title_updated_v1"
    - "drive.file.trashed_v1"

# æ—¥å¿—é…ç½®
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "/app/logs/app.log"
  max_size: "100MB"
  backup_count: 5
```

---

## ğŸ” é£ä¹¦APIæƒé™é…ç½®

### å¿…éœ€çš„APIæƒé™

**åº”ç”¨æƒé™ç”³è¯·æ¸…å•:**
```yaml
# æ–‡æ¡£ç›¸å…³æƒé™
document_permissions:
  - "drive:drive"              # äº‘æ–‡æ¡£åŸºç¡€æƒé™
  - "docs:doc"                # é£ä¹¦æ–‡æ¡£æƒé™  
  - "sheets:spreadsheet"      # é£ä¹¦è¡¨æ ¼æƒé™
  - "wiki:wiki"               # é£ä¹¦çŸ¥è¯†åº“æƒé™
  - "bitable:app"             # å¤šç»´è¡¨æ ¼æƒé™

# ç”¨æˆ·å’Œç»„ç»‡æƒé™
user_permissions:
  - "contact:user.base:readonly"     # è¯»å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
  - "contact:department.base:readonly" # è¯»å–éƒ¨é—¨ä¿¡æ¯

# æœºå™¨äººæƒé™
bot_permissions:
  - "im:message"              # å‘é€æ¶ˆæ¯æƒé™
  - "im:message.group_at_msg" # ç¾¤èŠ@æ¶ˆæ¯æƒé™
```

### å®‰å…¨é…ç½®è¦ç‚¹

**1. Tokenå®‰å…¨ç®¡ç†**
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- å®šæœŸåˆ·æ–°Access Token
- å®ç°Tokenå¤±æ•ˆè‡ªåŠ¨é‡è¯•æœºåˆ¶

**2. æƒé™æœ€å°åŒ–åŸåˆ™**
- åªç”³è¯·å¿…éœ€çš„æœ€å°æƒé™
- æŒ‰ç”¨æˆ·è§’è‰²æ§åˆ¶æ–‡æ¡£è®¿é—®
- å®šæœŸå®¡è®¡æƒé™ä½¿ç”¨æƒ…å†µ

**3. æ•°æ®å®‰å…¨**
- æœ¬åœ°å‘é‡åº“åŠ å¯†å­˜å‚¨
- APIè°ƒç”¨æ—¥å¿—è„±æ•å¤„ç†
- å®ç°æ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

### é£ä¹¦åº”ç”¨åˆ›å»ºæ­¥éª¤

**Step 1: åˆ›å»ºé£ä¹¦ä¼ä¸šåº”ç”¨**
```bash
1. è®¿é—® https://open.feishu.cn/app
2. ç‚¹å‡»"åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨"
3. å¡«å†™åº”ç”¨åç§°ï¼š"äº§å“æ–‡æ¡£AIåŠ©æ‰‹"
4. é€‰æ‹©åº”ç”¨ç±»å‹ï¼š"æœºå™¨äºº"
5. ä¸Šä¼ åº”ç”¨å›¾æ ‡å’Œæè¿°
```

**Step 2: é…ç½®æƒé™èŒƒå›´**
```bash
1. è¿›å…¥"æƒé™ç®¡ç†"é¡µé¢
2. æŒ‰ç…§ä¸Šè¿°æƒé™æ¸…å•ç”³è¯·æƒé™
3. æäº¤å®¡æ ¸ï¼ˆé€šå¸¸éœ€è¦1-3ä¸ªå·¥ä½œæ—¥ï¼‰
4. è·å¾—ç®¡ç†å‘˜æ‰¹å‡†åç”Ÿæ•ˆ
```

**Step 3: è·å–åº”ç”¨å‡­è¯**
```bash
1. è®°å½• App ID å’Œ App Secret
2. é…ç½®æœåŠ¡å™¨å›è°ƒåœ°å€
3. è®¾ç½®äº‹ä»¶è®¢é˜…Webhook
4. æµ‹è¯•APIè°ƒç”¨æ˜¯å¦æ­£å¸¸
```

---

## ğŸ“Š æ•ˆæœé¢„æœŸä¸æˆæœ¬åˆ†æ

### é¢„æœŸæ•ˆæœ

**æ•ˆç‡æå‡:**
- ğŸ“ˆ æ–‡æ¡£æŸ¥æ‰¾æ—¶é—´å‡å°‘ **80%** (ä»å¹³å‡30åˆ†é’Ÿé™è‡³5åˆ†é’Ÿ)
- ğŸ¯ æŸ¥è¯¢å‡†ç¡®ç‡è¾¾åˆ° **90%ä»¥ä¸Š**
- ğŸ“± æ”¯æŒç§»åŠ¨ç«¯æŸ¥è¯¢ï¼Œéšæ—¶éšåœ°è®¿é—®
- ğŸ”„ æ–‡æ¡£æ›´æ–°é€šçŸ¥åŠæ—¶ç‡ **100%**

**ç”¨æˆ·ä½“éªŒ:**
- ğŸ’¬ è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼Œæ— éœ€è®°å¿†å…³é”®è¯
- ğŸ“± å¤šç«¯è®¿é—®ï¼ŒWeb + ç§»åŠ¨ç«¯ + é£ä¹¦
- ğŸ” æ™ºèƒ½æ¨èç›¸å…³æ–‡æ¡£
- ğŸ“Š å¯è§†åŒ–çš„æŸ¥è¯¢ç»“æœå±•ç¤º

### æˆæœ¬åˆ†æ

**å¼€å‘æˆæœ¬:**
```
äººåŠ›æˆæœ¬ï¼š
- åç«¯å¼€å‘å·¥ç¨‹å¸ˆ 1äºº Ã— 2ä¸ªæœˆ = 40K
- å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ 1äºº Ã— 1ä¸ªæœˆ = 20K  
- äº§å“ç»ç† 0.5äºº Ã— 2ä¸ªæœˆ = 15K
- æµ‹è¯•å·¥ç¨‹å¸ˆ 0.5äºº Ã— 1ä¸ªæœˆ = 8K
å°è®¡ï¼š83K

æŠ€æœ¯æˆæœ¬ï¼š
- OpenAI APIè´¹ç”¨ï¼šçº¦500å…ƒ/æœˆ
- æœåŠ¡å™¨è´¹ç”¨ï¼šçº¦2000å…ƒ/æœˆ
- å…¶ä»–å·¥å…·è´¹ç”¨ï¼šçº¦300å…ƒ/æœˆ
å°è®¡ï¼š2800å…ƒ/æœˆ
```

**æŠ•èµ„å›æŠ¥ç‡(ROI):**
```
æ—¶é—´æˆæœ¬èŠ‚çœï¼š
- 20äººå›¢é˜Ÿ Ã— 2å°æ—¶/å‘¨ Ã— 4å‘¨/æœˆ Ã— 500å…ƒ/å°æ—¶ = 80K/æœˆ

æ•ˆç‡æå‡ä»·å€¼ï¼š
- å‡å°‘é‡å¤å·¥ä½œï¼Œæå‡å†³ç­–é€Ÿåº¦
- é¢„ä¼°ä»·å€¼ï¼š20K/æœˆ

æ€»æ”¶ç›Šï¼š100K/æœˆ
æŠ•èµ„å›æ”¶æœŸï¼šçº¦1ä¸ªæœˆ
å¹´åŒ–ROIï¼šçº¦1300%
```

---

## ğŸ”„ åç»­æ‰©å±•è§„åˆ’

### Phase 4: æ™ºèƒ½åŒ–å¢å¼ºï¼ˆæœªæ¥6ä¸ªæœˆï¼‰

**å¤šæ¨¡æ€æ”¯æŒ:**
- ğŸ“· å›¾ç‰‡è¯†åˆ«å’Œç†è§£ï¼ˆæµç¨‹å›¾ã€åŸå‹å›¾ï¼‰
- ğŸ¥ è§†é¢‘å†…å®¹åˆ†æï¼ˆäº§å“æ¼”ç¤ºè§†é¢‘ï¼‰
- ğŸ“Š è¡¨æ ¼æ•°æ®æ™ºèƒ½è§£æ

**æ™ºèƒ½å†™ä½œåŠ©æ‰‹:**
- ğŸ“ åŸºäºå†å²æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆæ–°éœ€æ±‚æ–‡æ¡£
- ğŸ”„ éœ€æ±‚å˜æ›´å½±å“åˆ†æ
- ğŸ“‹ è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹

**å›¢é˜Ÿåä½œå¢å¼º:**
- ğŸ’¬ é›†æˆé’‰é’‰ã€ä¼ä¸šå¾®ä¿¡
- ğŸ“… ä¸é¡¹ç›®ç®¡ç†å·¥å…·é›†æˆï¼ˆJiraã€Trelloï¼‰
- ğŸ”” æ™ºèƒ½æé†’å’Œä»»åŠ¡åˆ†é…

### Phase 5: ç”Ÿæ€åŒ–é›†æˆï¼ˆæœªæ¥12ä¸ªæœˆï¼‰

**å¼€å‘å·¥å…·é›†æˆ:**
- ğŸ”§ ä¸IDEé›†æˆï¼ˆVS Codeæ’ä»¶ï¼‰
- ğŸ“± ç§»åŠ¨ç«¯åŸç”Ÿåº”ç”¨
- ğŸŒ æµè§ˆå™¨æ’ä»¶

**æ•°æ®æ´å¯Ÿ:**
- ğŸ“ˆ æ–‡æ¡£ä½¿ç”¨æƒ…å†µåˆ†æ
- ğŸ¯ çƒ­é—¨éœ€æ±‚è¯†åˆ«
- ğŸ“Š å›¢é˜ŸçŸ¥è¯†å›¾è°±æ„å»º

---

## âœ… ç»“è®ºä¸å»ºè®®

### é¡¹ç›®å¯è¡Œæ€§è¯„ä¼°: â­â­â­â­â­

**æŠ€æœ¯å¯è¡Œæ€§:** ğŸŸ¢ **é«˜**
- Einoæ¡†æ¶æˆç†Ÿç¨³å®šï¼Œç¤¾åŒºæ´»è·ƒ
- RAGæŠ€æœ¯æ–¹æ¡ˆç»è¿‡éªŒè¯
- æ‰€éœ€æŠ€æœ¯æ ˆå›¢é˜Ÿå·²æŒæ¡

**å•†ä¸šä»·å€¼:** ğŸŸ¢ **é«˜**
- ç›´æ¥è§£å†³å›¢é˜Ÿç—›ç‚¹
- ROIæ˜¾è‘—ï¼ŒæŠ•èµ„å›æ”¶æœŸçŸ­
- å¯æ‰©å±•åˆ°å…¶ä»–ä¸šåŠ¡åœºæ™¯

**å®æ–½é£é™©:** ğŸŸ¡ **ä½**
- æŠ€æœ¯é£é™©å¯æ§
- å¼€å‘å‘¨æœŸåˆç†
- æœ‰é™çº§æ–¹æ¡ˆ

### é£ä¹¦é›†æˆç‰¹æ®Šä¼˜åŠ¿:

**ğŸ¯ æ— ç¼ä½“éªŒ:**
- æ–‡æ¡£æºå¤´ç›´æ¥æ¥å…¥ï¼Œæ— éœ€å¯¼å‡ºå¯¼å…¥
- æƒé™ä½“ç³»å¤©ç„¶åŒæ­¥ï¼Œå®‰å…¨å¯é 
- ç”¨æˆ·æ— éœ€å­¦ä¹ æ–°å·¥å…·ï¼Œåœ¨é£ä¹¦å†…ç›´æ¥ä½¿ç”¨

**ğŸ”„ å®æ—¶æ€§å¼º:**
- Webhookå®æ—¶ç›‘å¬æ–‡æ¡£å˜æ›´
- å¢é‡æ›´æ–°ï¼Œèµ„æºæ¶ˆè€—ä½
- å›¢é˜Ÿåä½œä¿¡æ¯åŠæ—¶åŒæ­¥

**ğŸ“± ç§»åŠ¨å‹å¥½:**
- é£ä¹¦ç§»åŠ¨ç«¯åŸç”Ÿæ”¯æŒ
- éšæ—¶éšåœ°æŸ¥è¯¢æ–‡æ¡£ä¿¡æ¯
- æ”¯æŒè¯­éŸ³è¾“å…¥å’Œè¯­éŸ³å›å¤

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®:

1. **é£ä¹¦åº”ç”¨ç”³è¯·:** ç«‹å³åˆ›å»ºä¼ä¸šåº”ç”¨å¹¶ç”³è¯·æƒé™ï¼ˆ3-5å¤©ï¼‰
2. **APIæ¥å£æµ‹è¯•:** éªŒè¯é£ä¹¦æ–‡æ¡£APIå¯ç”¨æ€§ï¼ˆ2å¤©ï¼‰
3. **Einoç¯å¢ƒæ­å»º:** é…ç½®å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒï¼ˆ3å¤©ï¼‰
4. **æ ¸å¿ƒåŠŸèƒ½å¼€å‘:** æŒ‰ç…§å®æ–½è®¡åˆ’å¼€å§‹å¼€å‘ï¼ˆ4å‘¨ï¼‰

**å…³é”®é‡Œç¨‹ç¢‘:**
- **ç¬¬1å‘¨:** é£ä¹¦APIé›†æˆå’Œæƒé™é…ç½®å®Œæˆ
- **ç¬¬2-3å‘¨:** æ–‡æ¡£åŒæ­¥å’Œå‘é‡åŒ–åŠŸèƒ½å¼€å‘  
- **ç¬¬4-5å‘¨:** æ™ºèƒ½é—®ç­”å’Œå®æ—¶æ›´æ–°åŠŸèƒ½
- **ç¬¬6å‘¨:** é£ä¹¦æœºå™¨äººå’Œç”¨æˆ·ç•Œé¢å¼€å‘
- **ç¬¬7-8å‘¨:** æµ‹è¯•ä¼˜åŒ–å’Œä¸Šçº¿éƒ¨ç½²

**é¢„è®¡é¡¹ç›®å¯åŠ¨æ—¶é—´:** 1å‘¨åï¼ˆç­‰å¾…é£ä¹¦æƒé™å®¡æ‰¹ï¼‰
**é¢„è®¡MVPç‰ˆæœ¬ä¸Šçº¿:** 6å‘¨å
**é¢„è®¡å®Œæ•´åŠŸèƒ½ä¸Šçº¿:** 8å‘¨å

---

*è¿™ä¸ªæ–¹æ¡ˆå……åˆ†åˆ©ç”¨äº†Einoæ¡†æ¶çš„ä¼˜åŠ¿ï¼Œæ—¢è§£å†³äº†å®é™…ä¸šåŠ¡ç—›ç‚¹ï¼Œåˆå…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ã€‚å»ºè®®ä¼˜å…ˆå¯åŠ¨ï¼* ğŸš€